



<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>3. Mas allá de la capa base, añadiendo mis propios datos - Curso WebGIS. Mapas libres con Leaflet y OpenLayers</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#mas-alla-de-la-capa-base-anadiendo-mis-propios-datos" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Curso WebGIS. Mapas libres con Leaflet y OpenLayers
              </span>
              <span class="md-header-nav__topic">
                3. Mas allá de la capa base, añadiendo mis propios datos
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Curso WebGIS. Mapas libres con Leaflet y OpenLayers
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../1_creando_mapa/" title="1. Creando un mapa" class="md-nav__link">
      1. Creando un mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../2_capas_base/" title="2. El mapa sin datos. Añadir una capa base" class="md-nav__link">
      2. El mapa sin datos. Añadir una capa base
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        3. Mas allá de la capa base, añadiendo mis propios datos
      </label>
    
    <a href="./" title="3. Mas allá de la capa base, añadiendo mis propios datos" class="md-nav__link md-nav__link--active">
      3. Mas allá de la capa base, añadiendo mis propios datos
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datos-vectoriales" title="Datos vectoriales" class="md-nav__link">
    Datos vectoriales
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-formato-geojson" title="El formato GeoJSON" class="md-nav__link">
    El formato GeoJSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-servicio-wfs-web-feature-service" title="El Servicio WFS, Web Feature Service" class="md-nav__link">
    El Servicio WFS, Web Feature Service
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-nav__link">
      4. Y si los datos son enormes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../5_interactuando_mapa/" title="5. Interactuando con el mapa" class="md-nav__link">
      5. Interactuando con el mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../6_osm_y_tilemill/" title="6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres" class="md-nav__link">
      6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../7_extra_1_osm_y_umap/" title="7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap" class="md-nav__link">
      7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#datos-vectoriales" title="Datos vectoriales" class="md-nav__link">
    Datos vectoriales
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-formato-geojson" title="El formato GeoJSON" class="md-nav__link">
    El formato GeoJSON
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#el-servicio-wfs-web-feature-service" title="El Servicio WFS, Web Feature Service" class="md-nav__link">
    El Servicio WFS, Web Feature Service
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/xeoinquedos/curso-webgis/edit/master/docs/3_mis_datos.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="mas-alla-de-la-capa-base-anadiendo-mis-propios-datos">Mas allá de la capa base, añadiendo mis propios datos</h1>
<div class="admonition note">
<p class="admonition-title">Autores</p>
<ul>
<li>Micho García · <a href="https://twitter.com/michogar">@michogar</a> · <a href="micho.garcia@geomati.co">micho.garcia@geomati.co</a></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Licencia</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />Esta obra está bajo una <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Atribución-CompartirIgual 4.0 Internacional</a>.</p>
</div>
<p>Hasta ahora hemos estado configurando capas que utilizábamos como base de nuestro mapa. Ahora queremos ir un paso más allá y mostrar datos por encima de esa capa base. De esta manera podríamos mostrar datos de carreteras, de rios, zonas de pesca o lo que nos sea interesante. </p>
<p>La primera interacción la haremos mostrando datos vectoriales. ¿Qué son los datos vectoriales?. Dentro del mundo de los datos geográficos, existen dos tipos de datos importantes, los vectoriales y los raster. </p>
<h2 id="datos-vectoriales">Datos vectoriales</h2>
<p>Estos datos están compuestos de una parte geométrica, donde se guarda la representación espacial, y de unos datos alfanuméricos, donde se guardarán los atributos del objeto, por ejemplo si se trata de una carretera estos podrían ser el tipo de carretera que es, el número de accidentes de esa carretera, el color con el que queremos que se visualice, etc, mientras que en la parte geométrica estaría el trazado de la carretera en si mismo. Los datos vectoriales serán puntos, lineas y polígonos con algunas variantes que no compenten en este curso.</p>
<p>Una representación de un dato vectorial podría ser, donde podremos ver la parte geométrica</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vigo&quot;</span><span class="p">,</span>
<span class="nt">&quot;crs&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;</span> <span class="p">}</span> <span class="p">},</span>
<span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> 
        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Vigo&quot;</span><span class="p">,</span> <span class="nt">&quot;Poblacion&quot;</span><span class="p">:</span> <span class="mi">500000</span> <span class="p">},</span> 
<span class="hll">        <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-8.733678516914864</span><span class="p">,</span> <span class="mf">42.219577180236797</span> <span class="p">]</span> <span class="p">}</span> 
</span>    <span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</td></tr></table>

<p>y la parte alfanumérica</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vigo&quot;</span><span class="p">,</span>
<span class="nt">&quot;crs&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;</span> <span class="p">}</span> <span class="p">},</span>
<span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> 
<span class="hll">        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Vigo&quot;</span><span class="p">,</span> <span class="nt">&quot;Poblacion&quot;</span><span class="p">:</span> <span class="mi">500000</span> <span class="p">},</span> 
</span>        <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-8.733678516914864</span><span class="p">,</span> <span class="mf">42.219577180236797</span> <span class="p">]</span> <span class="p">}</span> 
    <span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</td></tr></table>

<p>Este último es un dato vectorial en formato <a href="https://en.wikipedia.org/wiki/GeoJSON">GeoJSON Wikipedia</a> un formato que es también parte del estandar desarrollado por la OGC y que no te hará</p>
<p><img alt="" src="../_images/200.gif" /></p>
<p>Si ahora quisiéramos visualizar este archivo en un visor, lo primero que haremos será crear una carpeta <code>ol-geojson</code> donde crearemos de nuevo nuestro archivo <code>index.html</code> con el esqueleto de nuestro visor y con alguna de las capas base que hemos visto anteriormente.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>GeoJSON y OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span>
      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Para poder visualizar nuestro dato vectorial, deberemos tener el mismo accesible desde nuestro visor. Para ello crearemos un archivo <code>vigo.geojson</code> en la carpeta anterior <code>ol-geojson</code> y copiaremos</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
<span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;vigo&quot;</span><span class="p">,</span>
<span class="nt">&quot;crs&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;</span> <span class="p">}</span> <span class="p">},</span>
<span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span> 
        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nt">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Vigo&quot;</span><span class="p">,</span> <span class="nt">&quot;Poblacion&quot;</span><span class="p">:</span> <span class="mi">500000</span> <span class="p">},</span> 
        <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span> <span class="mf">-8.733678516914864</span><span class="p">,</span> <span class="mf">42.219577180236797</span> <span class="p">]</span> <span class="p">}</span> 
    <span class="p">}</span>
<span class="p">]}</span>
</pre></div>
</td></tr></table>

<p>Ahora si vamos a nuestro navegador a la ruta <a href="http://localhost:8080/vigo.geojson">http://localhost:8080/vigo.geojson</a> este debería descargarnos el archivo que acabamos de crear.</p>
<p>Ahora añadiremos este dato a nuestro visor. Para ello utilizaremos una nueva capa con una nueva fuente de datos. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>GeoJSON y OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
<span class="hll">      <span class="kr">const</span> <span class="nx">vigo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
</span><span class="hll">        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;vigo.geojson&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">format</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">()</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">      <span class="p">})</span>
</span>      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span><span class="p">,</span>
<span class="hll">        <span class="nx">vigo</span>
</span>      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Si inspeccionamos la pestaña <em>Network</em> de la herramienta de desarrollo del navegador, veremos que es realiza la petición al archivo <em>GeoJSON</em> correctamente, y veremos que se visualiza un círculo azul. Esto es debido a que las capas que hasta ahora hemos consumido tienen su propio estilo, es decir, los colores, etc de las geometrías ya están definidas. Sin embargo en el caso de nuestro dato vectorial, solo nos hemos descargado el dato y tendremos que simbolizarlo.</p>
<p>Tendremos que tener en cuenta el tipo de geometría que vamos a estilizar para saber que propiedades podemos usar. Por ejemplo, podremos definir el radio de un punto pero no de una línea, y cosas de este tipo. En nuestro caso como se trata de un punto, definiremos un círculo de color. Para ello creamos un estilo en OpenLayers de la siguiente manera</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>GeoJSON y OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="hll">        <span class="kr">const</span> <span class="nx">stroke</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Stroke</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="nx">width</span><span class="o">:</span> <span class="mi">2</span><span class="p">});</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">fill</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Fill</span><span class="p">({</span><span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">});</span>
</span><span class="hll">
</span><span class="hll">        <span class="kr">const</span> <span class="nx">style</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Style</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">image</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Circle</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">fill</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">stroke</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">radius</span><span class="o">:</span> <span class="mi">30</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">})</span>
</span>        <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">vigo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;vigo.geojson&quot;</span><span class="p">,</span>
                <span class="nx">format</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">()</span>
            <span class="p">}),</span>
<span class="hll">            <span class="nx">style</span>
</span>        <span class="p">})</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
            <span class="p">}),</span>
        <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
            <span class="nx">PNOA</span><span class="p">,</span>
            <span class="nx">vigo</span>
        <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Si os fijáis de donde se aplica el estilo veréis que se aplica a nivel de capa. Una capa tiene una fuente de datos, y es la capa la que se encargará de aplicar los estilos a esa fuente de datos.</p>
<h2 id="el-formato-geojson">El formato GeoJSON</h2>
<p>El formato GeoJSON es una de las maneras más habituales en las que encontraréis los datos geográficos en la web. Existen otras alternaticas como el <a href="https://en.wikipedia.org/wiki/Keyhole_Markup_Language">KML Wikipedia</a> o el <a href="https://en.wikipedia.org/wiki/Geography_Markup_Language">GML</a> ambos basados en XML. Estos formatos también están disponibles, pero son más complejos y difíciles de usar, a la vez que utilizan más espacio para la representación del dato quedando en franco retroceso con respecto al GeoJSON. Algo similar a lo que está pasando entre el XML y el JSON.</p>
<p>La especificación del GeoJSON la podréis encontrar en <a href="http://geojson.org/">http://geojson.org/</a> sin embargo, más allá de la misma, de manera sencilla podremos definir un GeoJSON similar al que usamos en el ejemplo anterior.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Dinagat Islands&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Point&quot;</span><span class="p">,</span>
        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">125.6</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Lo que hemos representado anteriormente se define como <code>Feature</code> que viene correspondiendo a un elemento que queramos definir geográficamente. En el caso anterior representámos una isla, pero bien podríamos representar un río</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
    <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nt">&quot;nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Lagares&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;LineString&quot;</span><span class="p">,</span>
        <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">[</span>
                <span class="p">[</span><span class="mf">-8.779801248386176</span><span class="p">,</span> <span class="mf">42.204426903310839</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.779541157795173</span><span class="p">,</span> <span class="mf">42.203256495651324</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.778804234453997</span><span class="p">,</span> <span class="mf">42.202823011332981</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.778847582885829</span><span class="p">,</span> <span class="mf">42.201609255241635</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.777937265817318</span><span class="p">,</span> <span class="mf">42.201045725627793</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.776203328543961</span><span class="p">,</span> <span class="mf">42.201262467786961</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.775206314611779</span><span class="p">,</span> <span class="mf">42.201392513082467</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.773905861656761</span><span class="p">,</span> <span class="mf">42.201392513082467</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.772562060269909</span><span class="p">,</span> <span class="mf">42.201305816218799</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.770958168292054</span><span class="p">,</span> <span class="mf">42.201089074059624</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.768530656109354</span><span class="p">,</span> <span class="mf">42.200959028764125</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.766840067267829</span><span class="p">,</span> <span class="mf">42.201045725627793</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.766319886085823</span><span class="p">,</span> <span class="mf">42.20121911935513</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.764022419198623</span><span class="p">,</span> <span class="mf">42.201695952105304</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.761551558584088</span><span class="p">,</span> <span class="mf">42.201565906809797</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.760554544651908</span><span class="p">,</span> <span class="mf">42.201565906809797</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.75869056208305</span><span class="p">,</span> <span class="mf">42.202259481719146</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.758300426196543</span><span class="p">,</span> <span class="mf">42.202519572310145</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.756263049900349</span><span class="p">,</span> <span class="mf">42.204210161151671</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.754442415763323</span><span class="p">,</span> <span class="mf">42.204773690765514</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.752578433194463</span><span class="p">,</span> <span class="mf">42.205987446856859</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.752578433194463</span><span class="p">,</span> <span class="mf">42.205987446856859</span><span class="p">],</span>
                <span class="p">[</span><span class="mf">-8.750714450625605</span><span class="p">,</span> <span class="mf">42.206030795288697</span><span class="p">]</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>Si nos fijamos podremos ver los tipos de geometrías definidos por el <code>type</code>, las colecciones de coordenadas que forman la geometría, así como las diferentes propiedades alfanuméricas de los elementos.</p>
<p>Sin embargo, normalmente los datos aparecen unidos dentro de una colección, lo que en el estandar se llama <code>FeatureCollection</code>, que es la encargada de definir un grupo de <code>Features</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
<span class="hll">    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;FeatureCollection&quot;</span><span class="p">,</span>
</span>    <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;illas&quot;</span><span class="p">,</span>
    <span class="nt">&quot;crs&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span>
        <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;urn:ogc:def:crs:OGC:1.3:CRS84&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="hll">    <span class="nt">&quot;features&quot;</span><span class="p">:</span> <span class="p">[{</span>
</span><span class="hll">            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
</span>            <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;fid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;Monteagudo&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
                <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="mf">-8.9177793069136</span><span class="p">,</span> <span class="mf">42.250809725373166</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.911016951547506</span><span class="p">,</span> <span class="mf">42.242486826461047</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.906855502091448</span><span class="p">,</span> <span class="mf">42.23537768364028</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.90876283309214</span><span class="p">,</span> <span class="mf">42.231216234184224</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.910496770365498</span><span class="p">,</span> <span class="mf">42.217691523452032</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.917605913186264</span><span class="p">,</span> <span class="mf">42.212663105359297</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.906508714636775</span><span class="p">,</span> <span class="mf">42.21248971163196</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.898705996906667</span><span class="p">,</span> <span class="mf">42.216824554815354</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.900960115362032</span><span class="p">,</span> <span class="mf">42.226707997273493</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.895411516087288</span><span class="p">,</span> <span class="mf">42.227228178455505</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.899572965543346</span><span class="p">,</span> <span class="mf">42.236418046004296</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.90269405263539</span><span class="p">,</span> <span class="mf">42.244220763734404</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.9177793069136</span><span class="p">,</span> <span class="mf">42.250809725373166</span><span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
<span class="hll">            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Feature&quot;</span><span class="p">,</span>
</span>            <span class="nt">&quot;properties&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;fid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                <span class="nt">&quot;Nombre&quot;</span><span class="p">:</span> <span class="s2">&quot;San Martiño&quot;</span>
            <span class="p">},</span>
            <span class="nt">&quot;geometry&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Polygon&quot;</span><span class="p">,</span>
                <span class="nt">&quot;coordinates&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">[</span>
                        <span class="p">[</span><span class="mf">-8.908069258182797</span><span class="p">,</span> <span class="mf">42.206941112357221</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.910843557820169</span><span class="p">,</span> <span class="mf">42.205727356265868</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.910843557820169</span><span class="p">,</span> <span class="mf">42.20087233190047</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.911537132729512</span><span class="p">,</span> <span class="mf">42.195323732625724</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.90512156481809</span><span class="p">,</span> <span class="mf">42.191855858079009</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.90061332790736</span><span class="p">,</span> <span class="mf">42.194109976534371</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.89489133490528</span><span class="p">,</span> <span class="mf">42.192549432988351</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.889862916812543</span><span class="p">,</span> <span class="mf">42.190468708260319</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.8891693419032</span><span class="p">,</span> <span class="mf">42.193243007897692</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.895238122359952</span><span class="p">,</span> <span class="mf">42.198444819717764</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.904427989908747</span><span class="p">,</span> <span class="mf">42.201392513082475</span><span class="p">],</span>
                        <span class="p">[</span><span class="mf">-8.908069258182797</span><span class="p">,</span> <span class="mf">42.206941112357221</span><span class="p">]</span>
                    <span class="p">]</span>
                <span class="p">]</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>En este ejemplo podemos ver como se crea una <code>FeatureCollection</code> que contiene dos <code>Features</code></p>
<h2 id="el-servicio-wfs-web-feature-service">El Servicio WFS, Web <strong>Feature</strong> Service</h2>
<p>Siguiendo con los datos vectoriales, y continuando con los servicios de datos, veremos ligeramente el servicio WFS. El servicio <a href="https://en.wikipedia.org/wiki/Web_Feature_Service">WFS Wikipedia</a> es un servicio que, mientras el servicio WMS devolvía imágenes generadas a partir de los datos, este servicio devolverá los datos originales. Solo está disponible para el dato vectorial. </p>
<p>El OGC, al igual que con el servicio WMS, nos marca una serie de consultas que podremos realizar contra este tipo de servicios. Al ser servicios más pesados, el volumen de datos que devuelven puede ser muy grande, es más dificil encontrarlos dentro de las IDEs, pero aun así existen multitud de ellos.</p>
<p>Por ejemplo, para el siguiente ejemplo, utilizaremos el servicio WFS de ADIF. Para ello nos dirigiremos a la web de la <a href="http://ideadif.adif.es/">IDE</a> de ADIF y dentro iremos a la zona de <em>Servicios WFS</em>.</p>
<p>Para utilizar un servicio WFS con OpenLayers, necesitaremos utilizar unos objetos ya conocidos. Pero antes, crearemos nuestra carpeta <code>ol-wfs</code> y dentro nuestra plantilla en el archivo <code>index.html</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>WFS y OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span>
      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Los objetos que vamos a utilizar serán, en primer lugar una fuente de datos de tipo vector <code>ol.source.Vector</code>, el formato <code>ol.format.GeoJSON</code>, la capa <code>ol.layer.VectorLayer</code> y los estilos <code>ol.style.Style</code>.</p>
<p>Como podemos ver, los objetos ya nos son conocidos, pero esta vez los configuraremos de diferente manera.</p>
<p>Lo primero definiremos la fuente de datos. Para ello utilizaremos el objeto <code>ol.source.Vector</code>, y le pasaremos la url del servicio WFS que queremos consumir.</p>
<p>La petición WFS tiene unos parámetros definidos, cuya explicación se escapa al contexto de este curso. Simplemente definiremos una petición y se explicará los parámetros mínimos necesarios. Lo primero que necesitaremos es la url base del servicio. En nuestro caso si desde la pestaña de servicios WFS vamos a <em>Capacidades</em> podremos ver una petición similar a la que realizamos con el formato WMS.</p>
<p><a href="http://ideadif.adif.es/gservices/Tramificacion/wfs?request=GetCapabilities">http://ideadif.adif.es/gservices/Tramificacion/wfs?request=GetCapabilities</a></p>
<p>Al igual que en el caso del WMS lo que nos mostrará será una descripción de los datos que tenemos disponibles. Buscaremos la capa que queremos consultar, en nuestro caso <code>TramosFueraServicio</code> y podremos ver el nombre de la capa en el servidor al igual que en el caso del WMS</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">&lt;FeatureType</span> <span class="na">xmlns:Tramificacion=</span><span class="s">&quot;http://ideadif.adif.es/tramificacion&quot;</span><span class="nt">&gt;</span>
<span class="hll"><span class="nt">&lt;Name&gt;</span>Tramificacion:TramosFueraServicio<span class="nt">&lt;/Name&gt;</span>
</span><span class="nt">&lt;Title&gt;</span>Tramos fuera de servicio<span class="nt">&lt;/Title&gt;</span>
<span class="nt">&lt;Abstract/&gt;</span>
<span class="nt">&lt;ows:Keywords&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Fuera_Servicio<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>features<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Tramos<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Fuera de servicio<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>IDEADIF<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Adif<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Tramificación común<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;ows:Keyword&gt;</span>Tramificación<span class="nt">&lt;/ows:Keyword&gt;</span>
<span class="nt">&lt;/ows:Keywords&gt;</span>
<span class="nt">&lt;DefaultCRS&gt;</span>urn:ogc:def:crs:EPSG::25830<span class="nt">&lt;/DefaultCRS&gt;</span>
<span class="nt">&lt;ows:WGS84BoundingBox&gt;</span>
<span class="nt">&lt;ows:LowerCorner&gt;</span>-8.914655683594248 36.53235585913574<span class="nt">&lt;/ows:LowerCorner&gt;</span>
<span class="nt">&lt;ows:UpperCorner&gt;</span>3.3319200917149243 43.65437766927871<span class="nt">&lt;/ows:UpperCorner&gt;</span>
<span class="nt">&lt;/ows:WGS84BoundingBox&gt;</span>
<span class="nt">&lt;MetadataURL</span> <span class="na">xlink:href=</span><span class="s">&quot;http://ideadif.adif.es/catalog/srv/spa/catalog.search#/metadata/8385b48c-2bac-42ea-a319-054d6755af12&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;MetadataURL</span> <span class="na">xlink:href=</span><span class="s">&quot;http://ideadif.adif.es/catalog/srv/spa/catalog.search#/metadata/7b6a0fdc-bcc4-40e9-a913-74fc6ef10914&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/FeatureType&gt;</span>
<span class="nt">&lt;/FeatureTypeList&gt;</span>
</pre></div>
</td></tr></table>

<p>Ahora definiremos la petición WFS que nos interesa siguiendo las normas del estandar.</p>
<p><a href="http://ideadif.adif.es/gservices/Tramificacion/wfs?service=WFS&amp;version=1.1.0&amp;request=GetFeature&amp;typename=Tramificacion:TramosFueraServicio&amp;outputFormat=application/json&amp;srsname=EPSG:3857">http://ideadif.adif.es/gservices/Tramificacion/wfs?service=WFS&amp;version=1.1.0&amp;request=GetFeature&amp;typename=Tramificacion:TramosFueraServicio&amp;outputFormat=application/json&amp;srsname=EPSG:3857</a></p>
<p>A tener en cuenta:</p>
<ul>
<li><code>srsname</code> nos indica el sistema de coordenadas en el que queremos que el servicio nos devuelva los datos</li>
<li><code>typename</code> será el valor del nombre de la capa</li>
<li>y en <code>ouputFormat</code> le indicamos al servidor en que formato queremos que nos devuelva los datos.</li>
</ul>
<p>Para esto último, es importante comprobar en las <a href="http://ideadif.adif.es/gservices/Tramificacion/wfs?request=GetCapabilities">capacidades</a> del servicio, que formatos tenemos disponibles</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">&lt;ows:Operation</span> <span class="na">name=</span><span class="s">&quot;GetFeature&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ows:DCP&gt;</span>
<span class="nt">&lt;ows:HTTP&gt;</span>
<span class="nt">&lt;ows:Get</span> <span class="na">xlink:href=</span><span class="s">&quot;http://ideadif.adif.es:80/gservices/Tramificacion/wfs&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;ows:Post</span> <span class="na">xlink:href=</span><span class="s">&quot;http://ideadif.adif.es:80/gservices/Tramificacion/wfs&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/ows:HTTP&gt;</span>
<span class="nt">&lt;/ows:DCP&gt;</span>
<span class="nt">&lt;ows:Parameter</span> <span class="na">name=</span><span class="s">&quot;resultType&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ows:AllowedValues&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>results<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>hits<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;/ows:AllowedValues&gt;</span>
<span class="nt">&lt;/ows:Parameter&gt;</span>
<span class="nt">&lt;ows:Parameter</span> <span class="na">name=</span><span class="s">&quot;outputFormat&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ows:AllowedValues&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>text/xml; subtype=gml/3.2<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>GML2<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>KML<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>SHAPE-ZIP<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>application/gml+xml; version=3.2<span class="nt">&lt;/ows:Value&gt;</span>
<span class="hll"><span class="nt">&lt;ows:Value&gt;</span>application/json<span class="nt">&lt;/ows:Value&gt;</span>
</span><span class="nt">&lt;ows:Value&gt;</span>application/vnd.google-earth.kml xml<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>application/vnd.google-earth.kml+xml<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>csv<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>gml3<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>gml32<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>json<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>text/xml; subtype=gml/2.1.2<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;ows:Value&gt;</span>text/xml; subtype=gml/3.1.1<span class="nt">&lt;/ows:Value&gt;</span>
<span class="nt">&lt;/ows:AllowedValues&gt;</span>
<span class="nt">&lt;/ows:Parameter&gt;</span>
<span class="nt">&lt;ows:Constraint</span> <span class="na">name=</span><span class="s">&quot;PagingIsTransactionSafe&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ows:NoValues/&gt;</span>
<span class="nt">&lt;ows:DefaultValue&gt;</span>FALSE<span class="nt">&lt;/ows:DefaultValue&gt;</span>
<span class="nt">&lt;/ows:Constraint&gt;</span>
<span class="nt">&lt;ows:Constraint</span> <span class="na">name=</span><span class="s">&quot;CountDefault&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;ows:NoValues/&gt;</span>
<span class="nt">&lt;ows:DefaultValue&gt;</span>1000000<span class="nt">&lt;/ows:DefaultValue&gt;</span>
<span class="nt">&lt;/ows:Constraint&gt;</span>
<span class="nt">&lt;/ows:Operation&gt;</span>
</pre></div>
</td></tr></table>

<p>Con esto ya estamos preparados para configurar la capa WFS dentro de nuestro visor.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>WFS y OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
      <span class="kr">const</span> <span class="nx">vectorSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
        <span class="nx">format</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">(),</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extent</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">          <span class="k">return</span> <span class="s1">&#39;https://cors-anywhere.herokuapp.com/http://ideadif.adif.es/gservices/Tramificacion/wfs?service=WFS&amp;version=1.1.0&amp;&#39;</span> <span class="o">+</span> 
</span>            <span class="s1">&#39;request=GetFeature&amp;typename=Tramificacion:TramosFueraServicio&amp;outputFormat=application/json&amp;srsname=EPSG:3857&amp;&#39;</span> <span class="o">+</span>
<span class="hll">            <span class="s1">&#39;bbox=&#39;</span> <span class="o">+</span> <span class="nx">extent</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,EPSG:3857&#39;</span><span class="p">;</span>
</span>        <span class="p">},</span>
<span class="hll">        <span class="nx">strategy</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">loadingstrategy</span><span class="p">.</span><span class="nx">bbox</span>
</span>      <span class="p">});</span>
      <span class="kr">const</span> <span class="nx">tramos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="nx">vectorSource</span><span class="p">,</span>
        <span class="nx">style</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Style</span><span class="p">({</span>
          <span class="nx">stroke</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Stroke</span><span class="p">({</span>
            <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="nx">width</span><span class="o">:</span> <span class="mi">2</span>
          <span class="p">})</span>
        <span class="p">})</span>
      <span class="p">});</span>
      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span><span class="p">,</span>
        <span class="nx">tramos</span>
      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>A resaltar varias cosas. La url del servicio tiene un añadido <code>https://cors-anywhere.herokuapp.com/</code>. Esto se encarga de actuar de proxy entre nuestro navegador y el servicio WFS para evitar un error por las <a href="https://enable-cors.org/">CORS</a>. Esto es algo muy común en el desarrollo web por lo que habrá que tenerlo en cuenta en el desarrollo de nuestros servicios.</p>
<p>Ahora la url se trata de una función en vez de una cadena de texto. Esto tiene que ver con la opción <code>strategy</code>, ya que lo que consigue el cliente es ir haciendo peticiones limitadas por un contorno en vez de hacer una petición con todas las geometrías del servicio.</p>
<p>Existen parámetros para limitar el número de objetos que queremos descargar del servicio WFS. Estos pueden ser <code>maxFeatures</code> o <code>count</code> el cual le indica un máximo de objetos a descargar y existe también la posibilidad de hacer filtros para obtener solo las features que nos interesan. Esto para un curso avanzado...</p>
<p><a href="./../leaflet/3_mis_datos">Probar con Leaflet</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../2_capas_base/" title="2. El mapa sin datos. Añadir una capa base" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                2. El mapa sin datos. Añadir una capa base
              </span>
            </div>
          </a>
        
        
          <a href="../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                4. Y si los datos son enormes
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>