



<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>AST traversal - Curso WebGIS. Mapas libres con Leaflet y OpenLayers</title>
      
    
    
      <link rel="stylesheet" href="../../../../../../../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../../../../../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../../../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../../../../../../../#ast-traversal" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../../../../../.." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Curso WebGIS. Mapas libres con Leaflet y OpenLayers
              </span>
              <span class="md-header-nav__topic">
                AST traversal
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../../../../../.." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Curso WebGIS. Mapas libres con Leaflet y OpenLayers
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../1_creando_mapa/" title="1. Creando un mapa" class="md-nav__link">
      1. Creando un mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../2_capas_base/" title="2. El mapa sin datos. Añadir una capa base" class="md-nav__link">
      2. El mapa sin datos. Añadir una capa base
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../3_mis_datos/" title="3. Mas allá de la capa base, añadiendo mis propios datos" class="md-nav__link">
      3. Mas allá de la capa base, añadiendo mis propios datos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-nav__link">
      4. Y si los datos son enormes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../5_interactuando_mapa/" title="5. Interactuando con el mapa" class="md-nav__link">
      5. Interactuando con el mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../6_osm_y_tilemill/" title="6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres" class="md-nav__link">
      6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../../../../../7_extra_1_osm_y_umap/" title="7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap" class="md-nav__link">
      7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#walkast-options" title="walk(ast, options)" class="md-nav__link">
    walk(ast, options)
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enter" title="enter" class="md-nav__link">
    enter
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#leave" title="leave" class="md-nav__link">
    leave
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#visit" title="visit" class="md-nav__link">
    visit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse" title="reverse" class="md-nav__link">
    reverse
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/xeoinquedos/curso-webgis/edit/master/docs/openlayers/ol-googlemaps/node_modules/csso/node_modules/css-tree/docs/traversal.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="ast-traversal">AST traversal</h1>
<p>AST traversal API is provided by <code>walk()</code> method.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;.a { color: red; }&#39;</span><span class="p">);</span>

<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
<span class="p">});</span>
<span class="c1">// StyleSheet</span>
<span class="c1">// Rule</span>
<span class="c1">// SelectorList</span>
<span class="c1">// Selector</span>
<span class="c1">// ClassSelector</span>
<span class="c1">// Block</span>
<span class="c1">// Declaration</span>
<span class="c1">// Value</span>
<span class="c1">// Identifier</span>
</pre></div>
</td></tr></table>

<p>The facts you should know about <code>walk()</code> internals:</p>
<ul>
<li>Method uses <code>structure</code> field value of every node type to define the way how to iterate the nodes:<ul>
<li>A function-iterator is generating for every node type.</li>
<li>Node's properties iterates in the order it defined in <code>structure</code> (<a href="#reverse">reverse</a> option can invert an order).</li>
<li>Properties that are not defined in <code>structure</code> are ignoring (doesn't interate).</li>
<li>An exception is possible when a tree is not following to expected structure (it may happen if AST was built outside the CSSTree parser or transformed in a wrong way). In case you are not sure about correctness of a tree structure, you can use <code>try/catch</code> or check the tree with <code>csstree.lexer.validateStructure(ast)</code> before iterate it.</li>
</ul>
</li>
<li>Only <code>children</code> fields can contain a list of nodes. A list of nodes should be represented as a <code>List</code> instances. But for certain cases, <code>children</code> can be an array. Since <code>List</code> provides a similar to <code>Array</code> API, traversal can work in most cases, but without any guarantee. Therefore usings arrays in AST is not recomended, use them on your own risk.</li>
</ul>
<h2 id="walkast-options">walk(ast, options)</h2>
<p>Method visits each node of passed tree in a natural way and calls a handler for each one. It takes two arguments: a root node (<code>ast</code>) and an object (<code>options</code>). In simple case, it can take a function (handler) instead of <code>options</code> (<code>walk(ast, fn)</code> is equivalent to <code>walk(ast, { enter: fn })</code>).</p>
<p>Options:</p>
<!-- MarkdownTOC -->

<ul>
<li><a href="#enter">enter</a></li>
<li><a href="#leave">leave</a></li>
<li><a href="#visit">visit</a></li>
<li><a href="#reverse">reverse</a></li>
</ul>
<!-- /MarkdownTOC -->

<h3 id="enter">enter</h3>
<p>Type: <code>function</code> or <code>undefined</code><br />
Default: <code>undefined</code></p>
<p>Handler on node entrance, i.e. before any nested node is processed.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;.a { color: red; }&#39;</span><span class="p">);</span>

<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="c1">// StyleSheet</span>
<span class="c1">// Rule</span>
<span class="c1">// SelectorList</span>
<span class="c1">// Selector</span>
<span class="c1">// ClassSelector</span>
<span class="c1">// Block</span>
<span class="c1">// Declaration</span>
<span class="c1">// Value</span>
<span class="c1">// Identifier</span>
</pre></div>
</td></tr></table>

<p>In case <code>options</code> has a single <code>enter</code> field, it can replaced for the handler passed as a value for <code>enter</code>, i.e. <code>walk(ast, { enter: fn })</code> → <code>walk(ast, fn)</code>.</p>
<p>Handler receives a three arguments:
- <code>node</code> – the AST node a walker entering to
- <code>item</code> – node wrapper, that contains references to <code>prev</code> and <code>next</code> nodes in a list, and <code>data</code> reference for the node
- <code>list</code> – is a reference for the list; it's useful for list operations like <code>remove()</code> or <code>insert()</code></p>
<blockquote>
<p>NOTE: If <code>children</code> is an array, the last two arguments are <code>index</code> and <code>array</code>, like for <code>Array#forEach()</code> or <code>Array#map()</code> methods.</p>
</blockquote>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">    .a { foo: 1; bar: 2; }</span>
<span class="sb">    .b { bar: 3; baz: 4; }</span>
<span class="sb">`</span><span class="p">);</span>

<span class="c1">// remove declarations with `bar` property from the tree</span>
<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">,</span> <span class="nx">item</span><span class="p">,</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;Declaration&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">property</span> <span class="o">===</span> <span class="s1">&#39;bar&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">list</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// remove a declaration from a list it</span>
        <span class="nx">list</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">csstree</span><span class="p">.</span><span class="nx">generate</span><span class="p">(</span><span class="nx">ast</span><span class="p">));</span>
<span class="c1">// .a{foo:1}.b{baz:4}</span>
</pre></div>
</td></tr></table>

<blockquote>
<p>NOTE:
- <code>item</code> and <code>list</code> are not defined for nodes that are not in a list. Even <code>Declaration</code> can be outside of any list in case it is a root of tree or a part of <code>@supports</code> prelude, e.g. <code>@supports (bar: 123) { ... }</code>. Therefore, it's recomended to check <code>item</code> or <code>list</code> are defined before using of it (those values both are defined or both are undefined, so it's enough to test one of them)
- Only <code>List</code> instances are safe for tree transformations such as node removal. In case you perform such operations, you can ensure that all <code>children</code> in a tree is a <code>List</code> instances by calling <code>csstree.fromPlainObject(ast)</code> before traversal.
- It's better to use <code>visit</code> option when possible to reach better performance</p>
</blockquote>
<p>Context (<code>this</code>) for a handler is an object with a references to the closest ancestor nodes:</p>
<ul>
<li><code>root</code> – refers to AST root node (actually it's a node passed to <code>walk()</code> method)</li>
<li><code>stylesheet</code> – refers to <code>StyleSheet</code> node, usually it's a root node</li>
<li><code>atrule</code> – refers to closest <code>Atrule</code> node if any</li>
<li><code>atrulePrelude</code> – refers to <code>AtrulePrelude</code> node if any</li>
<li><code>rule</code> – refers to closest <code>Rule</code> node if any</li>
<li><code>selector</code> – refers to <code>SelectorList</code> node if any</li>
<li><code>block</code> - refers to closest <code>Block</code> node if any</li>
<li><code>declaration</code> – refers to <code>Declaration</code> node if any</li>
<li><code>function</code> – refers to closest <code>Function</code>, <code>PseudoClassSelector</code> or <code>PseudoElementSelector</code> node if current node inside one of them</li>
</ul>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kr">const</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="sb">`</span>
<span class="sb">    @import url(import.css);</span>
<span class="sb">    .foo { background: url(&#39;foo.jpg&#39;); }</span>
<span class="sb">    .bar { background-image: url(bar.png); }</span>
<span class="sb">`</span><span class="p">);</span>

<span class="c1">// collect all urls in declarations</span>
<span class="kr">const</span> <span class="nx">urls</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">declaration</span> <span class="o">!==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;Url&#39;</span><span class="p">)</span> <span class="p">{</span>
        <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;Raw&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">urls</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">urls</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">value</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nx">value</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">2</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">urls</span><span class="p">);</span>
<span class="c1">// [ &#39;foo.jpg&#39;, &#39;bar.png&#39; ]</span>
</pre></div>
</td></tr></table>

<h3 id="leave">leave</h3>
<p>Type: <code>function</code> or <code>undefined</code><br />
Default: <code>undefined</code></p>
<p>The same as <code>enter</code> handler but invokes on node exit, i.e. after all nested nodes are processed.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;.a { color: red; }&#39;</span><span class="p">);</span>

<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">leave</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="c1">// ClassSelector</span>
<span class="c1">// Selector</span>
<span class="c1">// SelectorList</span>
<span class="c1">// Identifier</span>
<span class="c1">// Value</span>
<span class="c1">// Declaration</span>
<span class="c1">// Block</span>
<span class="c1">// Rule</span>
<span class="c1">// StyleSheet</span>
</pre></div>
</td></tr></table>

<h3 id="visit">visit</h3>
<p>Type: <code>string</code> or <code>null</code><br />
Default: <code>null</code></p>
<p>Invokes a handler for a specified node type only.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;.a { color: red; } .b { color: green; }&#39;</span><span class="p">);</span>

<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">visit</span><span class="o">:</span> <span class="s1">&#39;ClassSelector&#39;</span><span class="p">,</span>
    <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// example above is equal to</span>
<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;ClassSelector&#39;</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<p>The traveral for some node types can performs faster (10-15 times depending on the CSS structure), because some subtrees may to be skipped since they can't contain a node of specified type (e.g. <code>Rule</code> can't be used inside of <code>Declaration</code>, so declaration's subtree can be exclude from traversal path). Fast traversal is supported for node types:</p>
<ul>
<li><code>Atrule</code></li>
<li><code>Rule</code></li>
<li><code>Declaration</code></li>
</ul>
<blockquote>
<p>NOTE: When fast traversal is applied, some nodes may not be reached in case of an incorrect location in the tree. That's may happen if AST was built outside the CSSTree parser or transformed in a wrong way. If you need to be 100% sure that every node of type will be visited (even in wrong position), don't use <code>visit</code> option and test node type by your own.</p>
</blockquote>
<h3 id="reverse">reverse</h3>
<p>Type: <code>boolean</code><br />
Default: <code>false</code></p>
<p>Inverts a natural order of traversal of nodes. To achieve this, the following actions are performed:
- children nodes are iterated in reverse order (from last to first)
- properties are iterated in reverse order (according to <code>structure</code> definition of node)
- <code>enter</code> and <code>leave</code> handlers are swapped</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">assert</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;assert&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">csstree</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;css-tree&#39;</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ast</span> <span class="o">=</span> <span class="nx">csstree</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="s1">&#39;.a { color: red; }&#39;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">natural</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">natural</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;enter &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">leave</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">natural</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;leave &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">reverse</span> <span class="o">=</span> <span class="p">[];</span>
<span class="nx">csstree</span><span class="p">.</span><span class="nx">walk</span><span class="p">(</span><span class="nx">ast</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">reverse</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">enter</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">reverse</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;enter &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">leave</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">reverse</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="s1">&#39;leave &#39;</span> <span class="o">+</span> <span class="nx">node</span><span class="p">.</span><span class="nx">type</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// will be truthy</span>
<span class="nx">assert</span><span class="p">.</span><span class="nx">deepEqual</span><span class="p">(</span>
    <span class="nx">reverse</span><span class="p">,</span>
    <span class="nx">natural</span><span class="p">.</span><span class="nx">reverse</span><span class="p">()</span>
<span class="p">);</span>
</pre></div>
</td></tr></table>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../../../../../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../../../../../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../../../../../../../../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../../../../../.."}})</script>
      
    
    
      
    
  </body>
</html>