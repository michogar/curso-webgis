



<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>Curso WebGIS. Mapas libres con Leaflet y OpenLayers</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../../../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../../../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../../../../#rbush" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../../.." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Curso WebGIS. Mapas libres con Leaflet y OpenLayers
              </span>
              <span class="md-header-nav__topic">
                Home
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../../.." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Curso WebGIS. Mapas libres con Leaflet y OpenLayers
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../../../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../1_creando_mapa/" title="1. Creando un mapa" class="md-nav__link">
      1. Creando un mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../2_capas_base/" title="2. El mapa sin datos. Añadir una capa base" class="md-nav__link">
      2. El mapa sin datos. Añadir una capa base
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../3_mis_datos/" title="3. Mas allá de la capa base, añadiendo mis propios datos" class="md-nav__link">
      3. Mas allá de la capa base, añadiendo mis propios datos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-nav__link">
      4. Y si los datos son enormes
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../5_interactuando_mapa/" title="5. Interactuando con el mapa" class="md-nav__link">
      5. Interactuando con el mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../6_osm_y_tilemill/" title="6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres" class="md-nav__link">
      6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../../../7_extra_1_osm_y_umap/" title="7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap" class="md-nav__link">
      7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#demos" title="Demos" class="md-nav__link">
    Demos
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#install" title="Install" class="md-nav__link">
    Install
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#usage" title="Usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-a-tree" title="Creating a Tree" class="md-nav__link">
    Creating a Tree
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-data" title="Adding Data" class="md-nav__link">
    Adding Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-data" title="Removing Data" class="md-nav__link">
    Removing Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-format" title="Data Format" class="md-nav__link">
    Data Format
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bulk-inserting-data" title="Bulk-Inserting Data" class="md-nav__link">
    Bulk-Inserting Data
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#search" title="Search" class="md-nav__link">
    Search
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#collisions" title="Collisions" class="md-nav__link">
    Collisions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#export-and-import" title="Export and Import" class="md-nav__link">
    Export and Import
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#k-nearest-neighbors" title="K-Nearest Neighbors" class="md-nav__link">
    K-Nearest Neighbors
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance" title="Performance" class="md-nav__link">
    Performance
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algorithms-used" title="Algorithms Used" class="md-nav__link">
    Algorithms Used
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#papers" title="Papers" class="md-nav__link">
    Papers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#development" title="Development" class="md-nav__link">
    Development
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compatibility" title="Compatibility" class="md-nav__link">
    Compatibility
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#changelog" title="Changelog" class="md-nav__link">
    Changelog
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#201-june-29-2016" title="2.0.1 &mdash; June 29, 2016" class="md-nav__link">
    2.0.1 &mdash; June 29, 2016
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#200-june-29-2016" title="2.0.0 &mdash; June 29, 2016" class="md-nav__link">
    2.0.0 &mdash; June 29, 2016
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#143-may-17-2016" title="1.4.3 &mdash; May 17, 2016" class="md-nav__link">
    1.4.3 &mdash; May 17, 2016
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#142-dec-16-2015" title="1.4.2 &mdash; Dec 16, 2015" class="md-nav__link">
    1.4.2 &mdash; Dec 16, 2015
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#141-sep-16-2015" title="1.4.1 &mdash; Sep 16, 2015" class="md-nav__link">
    1.4.1 &mdash; Sep 16, 2015
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#140-apr-22-2015" title="1.4.0 &mdash; Apr 22, 2015" class="md-nav__link">
    1.4.0 &mdash; Apr 22, 2015
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#134-aug-31-2014" title="1.3.4 &mdash; Aug 31, 2014" class="md-nav__link">
    1.3.4 &mdash; Aug 31, 2014
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#133-aug-30-2014" title="1.3.3 &mdash; Aug 30, 2014" class="md-nav__link">
    1.3.3 &mdash; Aug 30, 2014
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#132-nov-25-2013" title="1.3.2 &mdash; Nov 25, 2013" class="md-nav__link">
    1.3.2 &mdash; Nov 25, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#131-nov-24-2013" title="1.3.1 &mdash; Nov 24, 2013" class="md-nav__link">
    1.3.1 &mdash; Nov 24, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#130-nov-21-2013" title="1.3.0 &mdash; Nov 21, 2013" class="md-nav__link">
    1.3.0 &mdash; Nov 21, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#125-nov-5-2013" title="1.2.5 &mdash; Nov 5, 2013" class="md-nav__link">
    1.2.5 &mdash; Nov 5, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#124-oct-25-2013" title="1.2.4 &mdash; Oct 25, 2013" class="md-nav__link">
    1.2.4 &mdash; Oct 25, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#123-aug-30-2013" title="1.2.3 &mdash; Aug 30, 2013" class="md-nav__link">
    1.2.3 &mdash; Aug 30, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#122-aug-27-2013" title="1.2.2 &mdash; Aug 27, 2013" class="md-nav__link">
    1.2.2 &mdash; Aug 27, 2013
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#120-jul-19-2013" title="1.2.0 &mdash; Jul 19, 2013" class="md-nav__link">
    1.2.0 &mdash; Jul 19, 2013
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/xeoinquedos/curso-webgis/edit/master/docs/openlayers/ol-googlemaps/node_modules/rbush/README.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="rbush">RBush</h1>
<p>RBush is a high-performance JavaScript library for 2D <strong>spatial indexing</strong> of points and rectangles.
It's based on an optimized <strong>R-tree</strong> data structure with <strong>bulk insertion</strong> support.</p>
<p><em>Spatial index</em> is a special data structure for points and rectangles
that allows you to perform queries like "all items within this bounding box" very efficiently
(e.g. hundreds of times faster than looping over all items).
It's most commonly used in maps and data visualizations.</p>
<p><a href="https://travis-ci.org/mourner/rbush"><img alt="Build Status" src="https://travis-ci.org/mourner/rbush.svg?branch=master" /></a>
<a href="https://github.com/mourner/projects"><img alt="" src="https://img.shields.io/badge/simply-awesome-brightgreen.svg" /></a></p>
<h2 id="demos">Demos</h2>
<p>The demos contain visualization of trees generated from 50k bulk-loaded random points.
Open web console to see benchmarks;
click on buttons to insert or remove items;
click to perform search under the cursor.</p>
<ul>
<li><a href="http://mourner.github.io/rbush/viz/viz-cluster.html">randomly clustered data</a></li>
<li><a href="http://mourner.github.io/rbush/viz/viz-uniform.html">uniformly distributed random data</a></li>
</ul>
<h2 id="install">Install</h2>
<p>Install with NPM (<code>npm install rbush</code>), or use CDN links for browsers:
<a href="https://unpkg.com/rbush@2.0.1/rbush.js">rbush.js</a>,
<a href="https://unpkg.com/rbush@2.0.1/rbush.min.js">rbush.min.js</a></p>
<h2 id="usage">Usage</h2>
<h3 id="creating-a-tree">Creating a Tree</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">rbush</span><span class="p">();</span>
</pre></div>
</td></tr></table>

<p>An optional argument to <code>rbush</code> defines the maximum number of entries in a tree node.
<code>9</code> (used by default) is a reasonable choice for most applications.
Higher value means faster insertion and slower search, and vice versa.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">rbush</span><span class="p">(</span><span class="mi">16</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<h3 id="adding-data">Adding Data</h3>
<p>Insert an item:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">item</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">minX</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="nx">minY</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="nx">maxX</span><span class="o">:</span> <span class="mi">30</span><span class="p">,</span>
    <span class="nx">maxY</span><span class="o">:</span> <span class="mi">50</span><span class="p">,</span>
    <span class="nx">foo</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span>
<span class="p">};</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<h3 id="removing-data">Removing Data</h3>
<p>Remove a previously inserted item:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">tree</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">item</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>By default, RBush removes objects by reference.
However, you can pass a custom <code>equals</code> function to compare by value for removal,
which is useful when you only have a copy of the object you need removed (e.g. loaded from server):</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">tree</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="nx">itemCopy</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nx">b</span><span class="p">.</span><span class="nx">id</span><span class="p">;</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<p>Remove all items:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">tree</span><span class="p">.</span><span class="nx">clear</span><span class="p">();</span>
</pre></div>
</td></tr></table>

<h3 id="data-format">Data Format</h3>
<p>By default, RBush assumes the format of data points to be an object
with <code>minX</code>, <code>minY</code>, <code>maxX</code> and <code>maxY</code> properties.
You can customize this by providing an array with corresponding accessor strings
as a second argument to <code>rbush</code> like this:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">rbush</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;[0]&#39;</span><span class="p">,</span> <span class="s1">&#39;[1]&#39;</span><span class="p">,</span> <span class="s1">&#39;[0]&#39;</span><span class="p">,</span> <span class="s1">&#39;[1]&#39;</span><span class="p">]);</span> <span class="c1">// accept [x, y] points</span>
<span class="nx">tree</span><span class="p">.</span><span class="nx">insert</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">50</span><span class="p">]);</span>
</pre></div>
</td></tr></table>

<p>If you're indexing a static list of points (you don't need to add/remove points after indexing), you should use <a href="https://github.com/mourner/kdbush">kdbush</a> which performs point indexing 5-8x faster than RBush.</p>
<h3 id="bulk-inserting-data">Bulk-Inserting Data</h3>
<p>Bulk-insert the given data into the tree:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">tree</span><span class="p">.</span><span class="nx">load</span><span class="p">([</span><span class="nx">item1</span><span class="p">,</span> <span class="nx">item2</span><span class="p">,</span> <span class="p">...]);</span>
</pre></div>
</td></tr></table>

<p>Bulk insertion is usually ~2-3 times faster than inserting items one by one.
After bulk loading (bulk insertion into an empty tree),
subsequent query performance is also ~20-30% better.</p>
<p>Note that when you do bulk insertion into an existing tree,
it bulk-loads the given data into a separate tree
and inserts the smaller tree into the larger tree.
This means that bulk insertion works very well for clustered data
(where items in one update are close to each other),
but makes query performance worse if the data is scattered.</p>
<h3 id="search">Search</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">search</span><span class="p">({</span>
    <span class="nx">minX</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span>
    <span class="nx">minY</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="nx">maxX</span><span class="o">:</span> <span class="mi">80</span><span class="p">,</span>
    <span class="nx">maxY</span><span class="o">:</span> <span class="mi">70</span>
<span class="p">});</span>
</pre></div>
</td></tr></table>

<p>Returns an array of data items (points or rectangles) that the given bounding box intersects.</p>
<p>Note that the <code>search</code> method accepts a bounding box in <code>{minX, minY, maxX, maxY}</code> format
regardless of the format specified in the constructor (which only affects inserted objects).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">allItems</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">all</span><span class="p">();</span>
</pre></div>
</td></tr></table>

<p>Returns all items of the tree.</p>
<h3 id="collisions">Collisions</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">collides</span><span class="p">({</span><span class="nx">minX</span><span class="o">:</span> <span class="mi">40</span><span class="p">,</span> <span class="nx">minY</span><span class="o">:</span> <span class="mi">20</span><span class="p">,</span> <span class="nx">maxX</span><span class="o">:</span> <span class="mi">80</span><span class="p">,</span> <span class="nx">maxY</span><span class="o">:</span> <span class="mi">70</span><span class="p">});</span>
</pre></div>
</td></tr></table>

<p>Returns <code>true</code> if there are any items intersecting the given bounding box, otherwise <code>false</code>.</p>
<h3 id="export-and-import">Export and Import</h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// export data as JSON object</span>
<span class="kd">var</span> <span class="nx">treeData</span> <span class="o">=</span> <span class="nx">tree</span><span class="p">.</span><span class="nx">toJSON</span><span class="p">();</span>

<span class="c1">// import previously exported data</span>
<span class="kd">var</span> <span class="nx">tree</span> <span class="o">=</span> <span class="nx">rbush</span><span class="p">(</span><span class="mi">9</span><span class="p">).</span><span class="nx">fromJSON</span><span class="p">(</span><span class="nx">treeData</span><span class="p">);</span>
</pre></div>
</td></tr></table>

<p>Importing and exporting as JSON allows you to use RBush on both the server (using Node.js) and the browser combined,
e.g. first indexing the data on the server and and then importing the resulting tree data on the client for searching.</p>
<p>Note that the <code>nodeSize</code> option passed to the constructor must be the same in both trees for export/import to work properly.</p>
<h3 id="k-nearest-neighbors">K-Nearest Neighbors</h3>
<p>For "<em>k</em> nearest neighbors around a point" type of queries for RBush,
check out <a href="https://github.com/mourner/rbush-knn">rbush-knn</a>.</p>
<h2 id="performance">Performance</h2>
<p>The following sample performance test was done by generating
random uniformly distributed rectangles of ~0.01% area and setting <code>maxEntries</code> to <code>16</code>
(see <code>debug/perf.js</code> script).
Performed with Node.js v6.2.2 on a Retina Macbook Pro 15 (mid-2012).</p>
<table>
<thead>
<tr>
<th>Test</th>
<th>RBush</th>
<th><a href="https://github.com/imbcmdth/RTree">old RTree</a></th>
<th>Improvement</th>
</tr>
</thead>
<tbody>
<tr>
<td>insert 1M items one by one</td>
<td>3.18s</td>
<td>7.83s</td>
<td>2.5x</td>
</tr>
<tr>
<td>1000 searches of 0.01% area</td>
<td>0.03s</td>
<td>0.93s</td>
<td>30x</td>
</tr>
<tr>
<td>1000 searches of 1% area</td>
<td>0.35s</td>
<td>2.27s</td>
<td>6.5x</td>
</tr>
<tr>
<td>1000 searches of 10% area</td>
<td>2.18s</td>
<td>9.53s</td>
<td>4.4x</td>
</tr>
<tr>
<td>remove 1000 items one by one</td>
<td>0.02s</td>
<td>1.18s</td>
<td>50x</td>
</tr>
<tr>
<td>bulk-insert 1M items</td>
<td>1.25s</td>
<td>n/a</td>
<td>6.7x</td>
</tr>
</tbody>
</table>
<h2 id="algorithms-used">Algorithms Used</h2>
<ul>
<li>single insertion: non-recursive R-tree insertion with overlap minimizing split routine from R*-tree (split is very effective in JS, while other R*-tree modifications like reinsertion on overflow and overlap minimizing subtree search are too slow and not worth it)</li>
<li>single deletion: non-recursive R-tree deletion using depth-first tree traversal with free-at-empty strategy (entries in underflowed nodes are not reinserted, instead underflowed nodes are kept in the tree and deleted only when empty, which is a good compromise of query vs removal performance)</li>
<li>bulk loading: OMT algorithm (Overlap Minimizing Top-down Bulk Loading) combined with Floyd–Rivest selection algorithm</li>
<li>bulk insertion: STLT algorithm (Small-Tree-Large-Tree)</li>
<li>search: standard non-recursive R-tree search</li>
</ul>
<h2 id="papers">Papers</h2>
<ul>
<li><a href="http://www-db.deis.unibo.it/courses/SI-LS/papers/Gut84.pdf">R-trees: a Dynamic Index Structure For Spatial Searching</a></li>
<li><a href="http://dbs.mathematik.uni-marburg.de/publications/myPapers/1990/BKSS90.pdf">The R*-tree: An Efficient and Robust Access Method for Points and Rectangles+</a></li>
<li><a href="http://ftp.informatik.rwth-aachen.de/Publications/CEUR-WS/Vol-74/files/FORUM_18.pdf">OMT: Overlap Minimizing Top-down Bulk Loading Algorithm for R-tree</a></li>
<li><a href="http://www.cs.arizona.edu/~bkmoon/papers/dke06-bulk.pdf">Bulk Insertions into R-Trees Using the Small-Tree-Large-Tree Approach</a></li>
<li><a href="http://www.apress.com/9781852339777">R-Trees: Theory and Applications (book)</a></li>
</ul>
<h2 id="development">Development</h2>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>npm install  <span class="c1"># install dependencies</span>

npm <span class="nb">test</span>     <span class="c1"># check the code with JSHint and run tests</span>
npm run perf <span class="c1"># run performance benchmarks</span>
npm run cov  <span class="c1"># report test coverage (with more detailed report in coverage/lcov-report/index.html)</span>
</pre></div>
</td></tr></table>

<h2 id="compatibility">Compatibility</h2>
<p>RBush should run on Node and all major browsers. The only caveat: IE 8 needs an <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf#Polyfill">Array#indexOf polyfill</a> for <code>remove</code> method to work.</p>
<h2 id="changelog">Changelog</h2>
<h4 id="201-june-29-2016">2.0.1 &mdash; June 29, 2016</h4>
<ul>
<li>Fixed browser builds in NPM.</li>
</ul>
<h4 id="200-june-29-2016">2.0.0 &mdash; June 29, 2016</h4>
<ul>
<li><strong>Breaking:</strong> changed the default format of inserted items from <code>[20, 40, 30, 50]</code> to <code>{minX: 20, minY: 40, maxX: 30, maxY: 50}</code>.</li>
<li><strong>Breaking:</strong> changed the <code>search</code> method argument format from <code>[20, 40, 30, 50]</code> to <code>{minX: 20, minY: 40, maxX: 30, maxY: 50}</code>.</li>
<li>Improved performance by up to 30%.</li>
<li>Added <code>equalsFn</code> optional argument to <code>remove</code> to be able to remove by value rather than by reference.</li>
<li>Changed the source code to use CommonJS module format. Browser builds are automatically built and published to NPM.</li>
<li>Quickselect algorithm (used internally) is now a <a href="https://github.com/mourner/quickselect">separate module</a>.</li>
</ul>
<h4 id="143-may-17-2016">1.4.3 &mdash; May 17, 2016</h4>
<ul>
<li>Fixed an error when inserting many empty bounding boxes.</li>
</ul>
<h4 id="142-dec-16-2015">1.4.2 &mdash; Dec 16, 2015</h4>
<ul>
<li>50% faster insertion.</li>
</ul>
<h4 id="141-sep-16-2015">1.4.1 &mdash; Sep 16, 2015</h4>
<ul>
<li>Fixed insertion in IE8.</li>
</ul>
<h4 id="140-apr-22-2015">1.4.0 &mdash; Apr 22, 2015</h4>
<ul>
<li>Added <code>collides</code> method for fast collision detection.</li>
</ul>
<h4 id="134-aug-31-2014">1.3.4 &mdash; Aug 31, 2014</h4>
<ul>
<li>Improved bulk insertion performance for a large number of items (e.g. up to 100% for inserting a million items).</li>
<li>Fixed performance regression for high node sizes.</li>
</ul>
<h4 id="133-aug-30-2014">1.3.3 &mdash; Aug 30, 2014</h4>
<ul>
<li>Improved bulk insertion performance by ~60-70%.</li>
<li>Improved insertion performance by ~40%.</li>
<li>Improved search performance by ~30%.</li>
</ul>
<h4 id="132-nov-25-2013">1.3.2 &mdash; Nov 25, 2013</h4>
<ul>
<li>Improved removal performance by ~50%. <a href="https://github.com/mourner/rbush/pull/18">#18</a></li>
</ul>
<h4 id="131-nov-24-2013">1.3.1 &mdash; Nov 24, 2013</h4>
<ul>
<li>Fixed minor error in the choose split axis algorithm. <a href="https://github.com/mourner/rbush/pull/17">#17</a></li>
<li>Much better test coverage (near 100%). <a href="https://github.com/mourner/rbush/issues/6">#6</a></li>
</ul>
<h4 id="130-nov-21-2013">1.3.0 &mdash; Nov 21, 2013</h4>
<ul>
<li>Significantly improved search performance (especially on large-bbox queries — up to 3x faster). <a href="https://github.com/mourner/rbush/pull/11">#11</a></li>
<li>Added <code>all</code> method for getting all of the tree items. <a href="https://github.com/mourner/rbush/pull/11">#11</a></li>
<li>Made <code>toBBox</code>, <code>compareMinX</code>, <code>compareMinY</code> methods public, made it possible to avoid Content Security Policy issues by overriding them for custom format. <a href="https://github.com/mourner/rbush/pull/14">#14</a> <a href="https://github.com/mourner/rbush/pull/12">#12</a></li>
</ul>
<h4 id="125-nov-5-2013">1.2.5 &mdash; Nov 5, 2013</h4>
<ul>
<li>Fixed a bug where insertion failed on a tree that had all items removed previously. <a href="https://github.com/mourner/rbush/issues/10">#10</a></li>
</ul>
<h4 id="124-oct-25-2013">1.2.4 &mdash; Oct 25, 2013</h4>
<ul>
<li>Added Web Workers support. <a href="https://github.com/mourner/rbush/pull/9">#9</a></li>
</ul>
<h4 id="123-aug-30-2013">1.2.3 &mdash; Aug 30, 2013</h4>
<ul>
<li>Added AMD support. <a href="https://github.com/mourner/rbush/pull/8">#8</a></li>
</ul>
<h4 id="122-aug-27-2013">1.2.2 &mdash; Aug 27, 2013</h4>
<ul>
<li>Eliminated recursion when recalculating node bboxes (on insert, remove, load).</li>
</ul>
<h4 id="120-jul-19-2013">1.2.0 &mdash; Jul 19, 2013</h4>
<p>First fully functional RBush release.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../../../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../../../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../../../../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:"../../../.."}})</script>
      
    
    
      
    
  </body>
</html>