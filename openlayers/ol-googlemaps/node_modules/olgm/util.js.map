{"version":3,"file":"util.js","sources":["../../src/olgm/util.js"],"sourcesContent":["/**\n * @module olgm/util\n */\nimport Feature from 'ol/Feature.js';\nimport {unByKey} from 'ol/Observable.js';\nimport {getCenter} from 'ol/extent.js';\nimport Point from 'ol/geom/Point.js';\nimport Polygon from 'ol/geom/Polygon.js';\nimport Vector from 'ol/layer/Vector.js';\nimport Style from 'ol/style/Style.js';\nimport {unlistenByKey} from './events.js';\n\n/**\n * @type {!Array<number>}\n */\nexport const RESOLUTIONS = [\n  156543.03390625,\n  78271.516953125,\n  39135.7584765625,\n  19567.87923828125,\n  9783.939619140625,\n  4891.9698095703125,\n  2445.9849047851562,\n  1222.9924523925781,\n  611.4962261962891,\n  305.74811309814453,\n  152.87405654907226,\n  76.43702827453613,\n  38.218514137268066,\n  19.109257068634033,\n  9.554628534317017,\n  4.777314267158508,\n  2.388657133579254,\n  1.194328566789627,\n  0.5971642833948135,\n  0.298582141697,\n  0.14929107084,\n  0.07464553542,\n  0.03732276771\n];\n\n\n/**\n * @param {module:ol/geom/Geometry} geometry the geometry to get the center of\n * @return {module:ol/coordinate~Coordinate} the center coordinates\n */\nexport function getCenterOf(geometry) {\n\n  let center = null;\n\n  if (geometry instanceof Point) {\n    center = geometry.getCoordinates();\n  } else if (geometry instanceof Polygon) {\n    center = geometry.getInteriorPoint().getCoordinates();\n  } else {\n    center = getCenter(geometry.getExtent());\n  }\n\n  return center;\n}\n\n\n/**\n * @param {module:ol/color~Color|module:ol/color~ColorLike} color the color\n * to parse\n * @return {string} the parsed color\n */\nexport function getColor(color) {\n\n  let out = '';\n  let rgba = null;\n\n  if (typeof color === 'string') {\n    // is string\n    if (stringStartsWith(color, 'rgba')) {\n      rgba = parseRGBA(color);\n    } else {\n      out = color;\n    }\n  } else if (Array.isArray(color)) {\n    rgba = color;\n  }\n\n  if (rgba !== null) {\n    out = ['rgb(', rgba[0], ',', rgba[1], ',', rgba[2], ')'].join('');\n  }\n\n  return out;\n}\n\n\n/**\n * @param {module:ol/color~Color|module:ol/color~ColorLike} color the color\n * to check\n * @return {?number} the color's opacity\n */\nexport function getColorOpacity(color) {\n\n  let opacity = null;\n  let rgba = null;\n\n  if (typeof color === 'string') {\n    // is string\n    if (stringStartsWith(color, 'rgba')) {\n      rgba = parseRGBA(color);\n    }\n  } else if (Array.isArray(color)) {\n    rgba = color;\n  }\n\n  if (rgba && rgba[3] !== undefined) {\n    opacity = +rgba[3];\n  }\n\n  return opacity;\n}\n\n\n/**\n * Get the style from the specified object.\n * @param {module:ol/style/Style|module:ol/style/Style~StyleFunction|module:ol/layer/Vector|module:ol/Feature}\n object object from which we get the style\n * @return {?module:ol/style/Style} the style of the object\n */\nexport function getStyleOf(object) {\n\n  let style = null;\n\n  if (object instanceof Style) {\n    style = object;\n  } else if (object instanceof Vector ||\n             object instanceof Feature) {\n    style = object.getStyle();\n    if (style && style instanceof Function) {\n      style = style()[0]; // todo - support multiple styles ?\n    }\n  } else if (object instanceof Function) {\n    style = object()[0]; // todo - support multiple styles ?\n  }\n\n  return style;\n}\n\n\n/**\n * @param {number} resolution the resolution to get the zoom from\n * @return {number} the zoom from the resolution, which can be fractional\n */\nexport function getZoomFromResolution(resolution) {\n\n  const resolutions = RESOLUTIONS;\n  let zoom;\n\n  let lowZoom = 0;\n  let highZoom = resolutions.length - 1;\n  let highRes = resolutions[lowZoom];\n  let lowRes = resolutions[highZoom];\n  let res;\n  for (let i = 0, len = resolutions.length; i < len; ++i) {\n    res = resolutions[i];\n    if (res >= resolution) {\n      highRes = res;\n      lowZoom = i;\n    }\n    if (res <= resolution) {\n      lowRes = res;\n      highZoom = i;\n      break;\n    }\n  }\n  const dRes = highRes - lowRes;\n  if (dRes > 0) {\n    zoom = lowZoom + ((highRes - resolution) / dRes);\n  } else {\n    zoom = lowZoom;\n  }\n\n  return Math.round(zoom * 1000) / 1000;\n}\n\n\n/**\n * Source: http://stackoverflow.com/questions/7543818/\\\n *     regex-javascript-to-match-both-rgb-and-rgba\n * @param {string} rgbaString the rgbaString to parse\n * @return {?Array<number>} the rgba color in number array format\n */\nexport function parseRGBA(rgbaString) {\n  let rgba = null;\n  const regex = /^rgba?\\((\\d+),\\s*(\\d+),\\s*(\\d+)(?:,\\s*(\\d+(?:\\.\\d+)?))?\\)$/;\n  const matches = rgbaString.match(regex);\n  if (matches && matches.length) {\n    rgba = [\n      +matches[1],\n      +matches[2],\n      +matches[3],\n      +matches[4]\n    ];\n  }\n  return rgba;\n}\n\n\n/**\n * @param {string} string string to check\n * @param {string} needle string to find\n * @return {boolean} whether or not the needle was found in the string\n */\nexport function stringStartsWith(string, needle) {\n  return (string.indexOf(needle) === 0);\n}\n\n\n/**\n * @param {Array<module:ol/events~EventsKey|Array<module:ol/events~EventsKey>>} listenerKeys listener\n * keys\n * @param {Array<module:ol/events~EventsKey>=} opt_olgmListenerKeys olgm listener keys\n */\nexport function unlistenAllByKey(listenerKeys, opt_olgmListenerKeys) {\n  listenerKeys.forEach(unByKey);\n  listenerKeys.length = 0;\n  if (opt_olgmListenerKeys) {\n    opt_olgmListenerKeys.forEach(unlistenByKey);\n    opt_olgmListenerKeys.length = 0;\n  }\n}\n\n/**\n * OL-Google-Maps version.\n * @type {string}\n */\nexport const VERSION = '0.21.0';\n"],"names":["const","let"],"mappings":"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"}