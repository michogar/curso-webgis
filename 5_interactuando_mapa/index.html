



<!DOCTYPE html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copiar al portapapeles">
      
        <meta name="lang:clipboard.copied" content="Copiado al portapapeles">
      
        <meta name="lang:search.language" content="es">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No se encontraron documentos">
      
        <meta name="lang:search.result.one" content="1 documento encontrado">
      
        <meta name="lang:search.result.other" content="# documentos encontrados">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.4">
    
    
      
        <title>5. Interactuando con el mapa - Curso WebGIS. Mapas libres con Leaflet y OpenLayers</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="../#5-interactuando-con-el-mapa" tabindex="1" class="md-skip">
        Saltar a contenido
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Curso WebGIS. Mapas libres con Leaflet y OpenLayers
              </span>
              <span class="md-header-nav__topic">
                5. Interactuando con el mapa
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Teclee para comenzar búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="Curso WebGIS. Mapas libres con Leaflet y OpenLayers" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    Curso WebGIS. Mapas libres con Leaflet y OpenLayers
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/xeoinquedos/curso-webgis/" title="Ir al repositorio" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      Curso WebGIS
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../1_creando_mapa/" title="1. Creando un mapa" class="md-nav__link">
      1. Creando un mapa
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../2_capas_base/" title="2. El mapa sin datos. Añadir una capa base" class="md-nav__link">
      2. El mapa sin datos. Añadir una capa base
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../3_mis_datos/" title="3. Mas allá de la capa base, añadiendo mis propios datos" class="md-nav__link">
      3. Mas allá de la capa base, añadiendo mis propios datos
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-nav__link">
      4. Y si los datos son enormes
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        5. Interactuando con el mapa
      </label>
    
    <a href="./" title="5. Interactuando con el mapa" class="md-nav__link md-nav__link--active">
      5. Interactuando con el mapa
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#control-de-capas" title="Control de capas" class="md-nav__link">
    Control de capas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algunos-controles-sencillos-mas" title="Algunos controles sencillos más" class="md-nav__link">
    Algunos controles sencillos más
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vista-de-pajaro" title="Vista de pájaro" class="md-nav__link">
    Vista de pájaro
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#posicion-del-raton" title="Posición del ratón" class="md-nav__link">
    Posición del ratón
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactuando-con-el-servidor" title="Interactuando con el servidor" class="md-nav__link">
    Interactuando con el servidor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactuando-en-el-cliente" title="Interactuando en el cliente" class="md-nav__link">
    Interactuando en el cliente
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../6_osm_y_tilemill/" title="6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres" class="md-nav__link">
      6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../7_extra_1_osm_y_umap/" title="7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap" class="md-nav__link">
      7. Extra 1. Un visor rápido con datos vectoriales de OSM usando uMap
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Tabla de contenidos</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#control-de-capas" title="Control de capas" class="md-nav__link">
    Control de capas
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#algunos-controles-sencillos-mas" title="Algunos controles sencillos más" class="md-nav__link">
    Algunos controles sencillos más
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vista-de-pajaro" title="Vista de pájaro" class="md-nav__link">
    Vista de pájaro
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#posicion-del-raton" title="Posición del ratón" class="md-nav__link">
    Posición del ratón
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactuando-con-el-servidor" title="Interactuando con el servidor" class="md-nav__link">
    Interactuando con el servidor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interactuando-en-el-cliente" title="Interactuando en el cliente" class="md-nav__link">
    Interactuando en el cliente
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/xeoinquedos/curso-webgis/edit/master/docs/5_interactuando_mapa.md" title="Editar esta página" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="5-interactuando-con-el-mapa">5. Interactuando con el mapa</h1>
<div class="admonition note">
<p class="admonition-title">Autores</p>
<ul>
<li>Micho García · <a href="https://twitter.com/michogar">@michogar</a> · <a href="micho.garcia@geomati.co">micho.garcia@geomati.co</a></li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Licencia</p>
<p><a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Licencia Creative Commons" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />Esta obra está bajo una <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Licencia Creative Commons Atribución-CompartirIgual 4.0 Internacional</a>.</p>
</div>
<p>Hasta ahora todo lo que hemos realizado con OpenLayers es la visualización de datos. En este punto de curso, trabajaremos con la interacción del usuario con el mapa a través de los controles que la librería pone a nuestra disposición.</p>
<p>En primer lugar instalaremos algunos de los controles básicos para tener un primer acercamiento al uso de estos dentro de la librería.</p>
<h2 id="control-de-capas">Control de capas</h2>
<p>Uno de los primeros controles que necesitaremos dentro de nuestro visor es un Arbol de capas. Este es un control básico en muchos visores, ya que nos permite modificar la visualización de las capas que tenemos configuradas en nuestro visor. Hasta la versión 3 de la librería existía un control de este tipo por defecto, mientras que a partir de esa versión se definió mejor la manera de colaborar con terceras partes, y ahora existen plugins que permiten añadir más funcionalidad a la librería.</p>
<p>Un listado de los plugins que podemos usar con OL la podemos tener directamente en su <a href="https://openlayers.org/3rd-party/">web</a></p>
<p>Para nuestro caso, utilizaremos el <a href="https://github.com/walkermatt/ol-layerswitcher"><code>OL-LayerSwitcher</code></a>, que nos aporta un arbol de capas fácilmente configurable.</p>
<p>Crearemos una carpeta <code>ol-layerswitcher</code> y dentro nuestra plantilla HTML en un archivo <code>index.html</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span>
      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Primero instalaremos el plugin</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
</span>  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>  
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
        <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
            <span class="nx">PNOA</span>
        <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Seguidamente crearemos las capas necesarias que queramos visualizar</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
<span class="hll">        <span class="c1">// Nuevas capas</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="c1">//       </span>
</span>        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
        <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
            <span class="nx">PNOA</span>
        <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Podemos ver que estamos usando un nuevo tipo de fuente <code>ol.source.Stamen</code>. <a href="http://maps.stamen.com/">Stamen</a> es una empresa muy relacionada con el OpenSource ,que también pone a disposición multiples servicios de teselas que pueden ser consumidos desde la librería. </p>
<p>Seguidamente crearemos la estructura del arbol de capas. Dentro de un arbol de capas principalmente encontraremos las capas que definimos como base, aquellas que queremos que siempre esten visibles, y las capas superpuestas, <code>overlays</code> que son aquellas que podremos activar y desactivar cuando deseemos.</p>
<p>Para realizar estos grupos de capas, capas base y superpuestas, utilizaremos un objeto de la librería, el <code>ol.layer.group</code> que nos permite agrupar capas. Crearemos un grupo con dos de las capas anteriores para ir conciendo el control</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
<span class="hll">        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
</span><span class="hll">                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
</span><span class="hll">                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
</span><span class="hll">                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
</span><span class="hll">                <span class="nx">watercolor</span><span class="p">,</span> 
</span><span class="hll">                <span class="nx">labels</span>
</span><span class="hll">            <span class="p">]</span>
</span><span class="hll">        <span class="p">})</span>
</span>        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
    <span class="c1">//</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
        <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
            <span class="nx">PNOA</span>
        <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Ahora en <code>waterWithLabels</code> tendremos un grupo de capas formado por dos capas. La propiedad <code>combine</code> nos indica que las dos capas serán combinadas y la propiedad <code>type</code> nos indicará que son de tipo <code>baselayer</code>.</p>
<p>Ahora seguiremos configurando los grupos de capas que manejaremos desde el arbol.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">watercolor</span><span class="p">,</span> 
                <span class="nx">labels</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">//</span>
<span class="hll">        <span class="c1">// Grupos del arbol</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
</span><span class="hll">            <span class="s1">&#39;title&#39;</span><span class="o">:</span> <span class="s1">&#39;Base maps&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
</span><span class="hll">                <span class="nx">waterWithLabels</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">watercolorHidden</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">osm</span>
</span><span class="hll">            <span class="p">]</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
</span><span class="hll">                <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Overlays&#39;</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
</span><span class="hll">                    <span class="nx">carreteras</span>
</span><span class="hll">                <span class="p">]</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="c1">//</span>
</span>        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
<span class="hll">                <span class="nx">baseLayers</span><span class="p">,</span>
</span><span class="hll">                <span class="nx">overlays</span>
</span>            <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Ahora tendremos las capas configuradas en el control de capas, pero necesitaremos añadir el control al mapa para poder utilizarlo.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">watercolor</span><span class="p">,</span> 
                <span class="nx">labels</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="c1">// Grupos del arbol</span>
        <span class="kr">const</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="s1">&#39;title&#39;</span><span class="o">:</span> <span class="s1">&#39;Base maps&#39;</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">waterWithLabels</span><span class="p">,</span>
                <span class="nx">watercolorHidden</span><span class="p">,</span>
                <span class="nx">osm</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
                <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Overlays&#39;</span><span class="p">,</span>
                <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                    <span class="nx">carreteras</span>
                <span class="p">]</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">baseLayers</span><span class="p">,</span>
                <span class="nx">overlays</span>
            <span class="p">]</span>
        <span class="p">});</span>

<span class="hll">        <span class="kr">const</span> <span class="nx">layerSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">LayerSwitcher</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">tipLabel</span><span class="o">:</span> <span class="s1">&#39;Arbol de Capas&#39;</span>
</span><span class="hll">        <span class="p">});</span>
</span><span class="hll">        <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">layerSwitcher</span><span class="p">);</span>
</span>    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<h2 id="algunos-controles-sencillos-mas">Algunos controles sencillos más</h2>
<p>Dentro de la librería disponemos de algunos controles sencillos de instalar. Estos serán por ejemplo el control de vista de pájaro, o el de posición de ratón. A continuación configuraremos ambos.</p>
<h3 id="vista-de-pajaro">Vista de pájaro</h3>
<p>Sobre el ejemplo anterior del control de capas, añadiremos el control de Vista de pájaro. Este viene en la librería OpenLayers como <code>ol.control.OverviewMap</code>. Para instalar nuevos controles, deberemos insertarlos en una propiedad del mapa denominada <code>controls</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">watercolor</span><span class="p">,</span> 
                <span class="nx">labels</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="c1">// Grupos del arbol</span>
        <span class="kr">const</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="s1">&#39;title&#39;</span><span class="o">:</span> <span class="s1">&#39;Base maps&#39;</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">waterWithLabels</span><span class="p">,</span>
                <span class="nx">watercolorHidden</span><span class="p">,</span>
                <span class="nx">osm</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
                <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Overlays&#39;</span><span class="p">,</span>
                <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                    <span class="nx">carreteras</span>
                <span class="p">]</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">baseLayers</span><span class="p">,</span>
                <span class="nx">overlays</span>
            <span class="p">],</span>
<span class="hll">            <span class="nx">controls</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">defaults</span><span class="p">().</span><span class="nx">extend</span><span class="p">([</span>
</span><span class="hll">                <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">OverviewMap</span><span class="p">()</span>
</span><span class="hll">            <span class="p">])</span>
</span>        <span class="p">});</span>

        <span class="kr">const</span> <span class="nx">layerSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">LayerSwitcher</span><span class="p">({</span>
            <span class="nx">tipLabel</span><span class="o">:</span> <span class="s1">&#39;Arbol de Capas&#39;</span>
        <span class="p">});</span>
        <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">layerSwitcher</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<h3 id="posicion-del-raton">Posición del ratón</h3>
<p>El control de posición del ratón nos permite obtener las coordenadas de la posición del ratón. Como el control anterior, se trata de un control que viene con la librería, en el objeto <code>ol.control.MousePosition</code>.</p>
<p>Para instalar el control, necesitaremos un sitio donde visualizar las coordenadas, así que lo primero crearemos esto.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;mouse-position&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">watercolor</span><span class="p">,</span> 
                <span class="nx">labels</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="c1">// Grupos del arbol</span>
        <span class="kr">const</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="s1">&#39;title&#39;</span><span class="o">:</span> <span class="s1">&#39;Base maps&#39;</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">waterWithLabels</span><span class="p">,</span>
                <span class="nx">watercolorHidden</span><span class="p">,</span>
                <span class="nx">osm</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
                <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Overlays&#39;</span><span class="p">,</span>
                <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                    <span class="nx">carreteras</span>
                <span class="p">]</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">baseLayers</span><span class="p">,</span>
                <span class="nx">overlays</span>
            <span class="p">],</span>
            <span class="nx">controls</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">defaults</span><span class="p">().</span><span class="nx">extend</span><span class="p">([</span>
                <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">OverviewMap</span><span class="p">()</span>
            <span class="p">])</span>
        <span class="p">});</span>

        <span class="kr">const</span> <span class="nx">layerSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">LayerSwitcher</span><span class="p">({</span>
            <span class="nx">tipLabel</span><span class="o">:</span> <span class="s1">&#39;Arbol de Capas&#39;</span>
        <span class="p">});</span>
        <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">layerSwitcher</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Después configuraremos el control y lo añadiremos al mapa</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Control de Capas en OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0/src/ol-layerswitcher.css&quot;</span> <span class="p">/&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;mouse-position&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://unpkg.com/ol-layerswitcher@3.0.0&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="c1">// Nuevas capas</span>
        <span class="kr">const</span> <span class="nx">watercolor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">labels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;terrain-labels&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">waterWithLabels</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Watercolor con etiquetas&quot;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
                    <span class="nx">combine</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
                    <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">watercolor</span><span class="p">,</span> 
                <span class="nx">labels</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">watercolorHidden</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Water color&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;watercolor&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">osm</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;OSM&#39;</span><span class="p">,</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;base&#39;</span><span class="p">,</span>
            <span class="nx">visible</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">OSM</span><span class="p">()</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">carreteras</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s2">&quot;Carreteras&quot;</span><span class="p">,</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
                <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/ign-base?&#39;</span><span class="p">,</span>
                <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;IGNBaseOrto&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="c1">//</span>
        <span class="c1">// Grupos del arbol</span>
        <span class="kr">const</span> <span class="nx">baseLayers</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
            <span class="s1">&#39;title&#39;</span><span class="o">:</span> <span class="s1">&#39;Base maps&#39;</span><span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">waterWithLabels</span><span class="p">,</span>
                <span class="nx">watercolorHidden</span><span class="p">,</span>
                <span class="nx">osm</span>
            <span class="p">]</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">overlays</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Group</span><span class="p">({</span>
                <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Overlays&#39;</span><span class="p">,</span>
                <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                    <span class="nx">carreteras</span>
                <span class="p">]</span>
        <span class="p">})</span>
        <span class="c1">//</span>
<span class="hll">        <span class="c1">// Control MousePosition</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">mousePositionControl</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">MousePosition</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">coordinateFormat</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">coordinate</span><span class="p">.</span><span class="nx">createStringXY</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span>
</span><span class="hll">            <span class="nx">projection</span><span class="o">:</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">className</span><span class="o">:</span> <span class="s1">&#39;custom-mouse-position&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">target</span><span class="o">:</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;mouse-position&#39;</span><span class="p">),</span>
</span><span class="hll">            <span class="nx">undefinedHTML</span><span class="o">:</span> <span class="s1">&#39;&amp;nbsp;&#39;</span>
</span><span class="hll">        <span class="p">});</span>
</span><span class="hll">        <span class="c1">//</span>
</span>        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">11</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">baseLayers</span><span class="p">,</span>
                <span class="nx">overlays</span>
            <span class="p">],</span>
            <span class="nx">controls</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">defaults</span><span class="p">().</span><span class="nx">extend</span><span class="p">([</span>
                <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">OverviewMap</span><span class="p">(),</span>
<span class="hll">                <span class="nx">mousePositionControl</span>
</span>            <span class="p">])</span>
        <span class="p">});</span>

        <span class="kr">const</span> <span class="nx">layerSwitcher</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">control</span><span class="p">.</span><span class="nx">LayerSwitcher</span><span class="p">({</span>
            <span class="nx">tipLabel</span><span class="o">:</span> <span class="s1">&#39;Arbol de Capas&#39;</span>
        <span class="p">});</span>
        <span class="nx">map</span><span class="p">.</span><span class="nx">addControl</span><span class="p">(</span><span class="nx">layerSwitcher</span><span class="p">);</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<h2 id="interactuando-con-el-servidor">Interactuando con el servidor</h2>
<p>Como ya hemos comentado, la mayoría de los servicios que estamos visualizando se encuentran en servidores desde los que nosotros consumimos sus datos a través de los diferentes servicios definidos para ello. Uno de los servicios con los que podemos interactuar será el servicio WMS. Este servicio nos permite realizar consultas sobre un punto determinado del mapa. Este tipo de consultas vienen definidas en el estandar como <a href="http://docs.geoserver.org/stable/en/user/services/wms/reference.html#getfeatureinfo"><code>GetFeatureInfo</code></a>. </p>
<p>Esta consulta es una de las más utilizadas para obtener información desde los servidores, y dentro de las librerías de mapas ya existen implementaciones de la petición que nos permiten configurar consultas desde el mapa.</p>
<p>Para empezar, crearemos una carpeta <code>ol-getfeatureinfo</code> con nuestro <code>index.html</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Interactuando con el servidor con OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">toner</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;toner&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
                <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">]),</span>
                <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">toner</span>
            <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Ahora configuraremos una capa WMS sobre la que haremos las consultas, por ejemplo la capa de <a href="http://wms.mapama.es/sig/Agua/RedHidrograficaMDT/wms.aspx?service=wms&amp;version=1.3.0&amp;request=GetCapabilities">rios</a> del Ministerio de Medio Ambiente. Si recordamos de los ejercicios anteriores, necesitaremos la URL base del servicio <code>http://wms.mapama.es/sig/Agua/RedHidrograficaMDT/wms.aspx?</code> y el nombre de la capa que obteníamos del archivo de capabilities.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="hll"><span class="nt">&lt;Layer</span> <span class="na">queryable=</span><span class="s">&quot;1&quot;</span><span class="nt">&gt;</span>
</span><span class="hll"><span class="nt">&lt;Name&gt;</span>HY.PhysicalWaters.Waterbodies<span class="nt">&lt;/Name&gt;</span>
</span><span class="nt">&lt;Title&gt;</span>Red hidrográfica básica MDT 100x100<span class="nt">&lt;/Title&gt;</span>
<span class="nt">&lt;Abstract&gt;</span>
Servicio Web de Mapas conforme al perfil INSPIRE de ISO19128-WMS 1.3.0 que permite acceder a conjunto de datos de la Red hidrográfica generada a partir del MDT de celda 100 x 100 (CEDEX). Generado por la Subdirección General de Infraestructuras y Tecnología (Ministerio de Agricultura y Pesca, Alimentación y Medio Ambiente).
<span class="nt">&lt;/Abstract&gt;</span>
<span class="nt">&lt;KeywordList&gt;</span>
<span class="nt">&lt;Keyword&gt;</span>HY.PhysicalWaters.Waterbodies<span class="nt">&lt;/Keyword&gt;</span>
<span class="nt">&lt;/KeywordList&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;CRS:84&quot;</span> <span class="na">minx=</span><span class="s">&quot;-22.729594&quot;</span> <span class="na">miny=</span><span class="s">&quot;25.912170&quot;</span> <span class="na">maxx=</span><span class="s">&quot;5.836872&quot;</span> <span class="na">maxy=</span><span class="s">&quot;45.945160&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:4230&quot;</span> <span class="na">minx=</span><span class="s">&quot;26.275447&quot;</span> <span class="na">miny=</span><span class="s">&quot;-18.409876&quot;</span> <span class="na">maxx=</span><span class="s">&quot;44.85536&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5.22598&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:4326&quot;</span> <span class="na">minx=</span><span class="s">&quot;26.275447&quot;</span> <span class="na">miny=</span><span class="s">&quot;-18.409876&quot;</span> <span class="na">maxx=</span><span class="s">&quot;44.85536&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5.22598&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:4258&quot;</span> <span class="na">minx=</span><span class="s">&quot;26.275447&quot;</span> <span class="na">miny=</span><span class="s">&quot;-18.409876&quot;</span> <span class="na">maxx=</span><span class="s">&quot;44.85536&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5.22598&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:32627&quot;</span> <span class="na">minx=</span><span class="s">&quot;770000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;2700000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:32628&quot;</span> <span class="na">minx=</span><span class="s">&quot;180000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;2170000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:23029&quot;</span> <span class="na">minx=</span><span class="s">&quot;-410000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1650000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:23030&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1050000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1150000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:23031&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1615000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;620000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:32629&quot;</span> <span class="na">minx=</span><span class="s">&quot;-410000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1650000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:32630&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1050000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1150000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:32631&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1615000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;620000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:25829&quot;</span> <span class="na">minx=</span><span class="s">&quot;-410000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1650000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:25830&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1050000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;1150000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:25831&quot;</span> <span class="na">minx=</span><span class="s">&quot;-1615000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;620000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5000000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;BoundingBox</span> <span class="na">CRS=</span><span class="s">&quot;EPSG:3857&quot;</span> <span class="na">minx=</span><span class="s">&quot;-2100000&quot;</span> <span class="na">miny=</span><span class="s">&quot;3000000&quot;</span> <span class="na">maxx=</span><span class="s">&quot;500000&quot;</span> <span class="na">maxy=</span><span class="s">&quot;5600000&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;Attribution&gt;</span>
<span class="nt">&lt;Title&gt;</span>
Ministerio de Agricultura y Pesca, Alimentación y Medio Ambiente (MAPAMA)
<span class="nt">&lt;/Title&gt;</span>
<span class="nt">&lt;OnlineResource</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;https://www.mapama.gob.es&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/Attribution&gt;</span>
<span class="nt">&lt;Identifier</span> <span class="na">authority=</span><span class="s">&quot;MAPAMA&quot;</span><span class="nt">&gt;</span>ESMAGRAMADGARIOS0007<span class="nt">&lt;/Identifier&gt;</span>
<span class="nt">&lt;MetadataURL</span> <span class="na">type=</span><span class="s">&quot;ISO19139:2005&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;Format&gt;</span>text/xml<span class="nt">&lt;/Format&gt;</span>
<span class="nt">&lt;OnlineResource</span> <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;https://www.mapama.gob.es/ide/metadatos/srv/spa/csw?SERVICE=CSW&amp;VERSION=2.0.2&amp;REQUEST=GetRecordById&amp;outputSchema=http://www.isotc211.org/2005/gmd&amp;ElementSetName=full&amp;ID=8bcffce8-9c9c-4d1e-9a3e-b83e175bbd27&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/MetadataURL&gt;</span>
<span class="nt">&lt;Style&gt;</span>
<span class="nt">&lt;Name&gt;</span>default<span class="nt">&lt;/Name&gt;</span>
<span class="nt">&lt;Title&gt;</span>
Estilo Ministerio Red hidrográfica básica MDT 100x100
<span class="nt">&lt;/Title&gt;</span>
<span class="nt">&lt;Abstract&gt;</span>
Estilo de representación MAPAMA de Red hidrográfica básica MDT 100x100
<span class="nt">&lt;/Abstract&gt;</span>
<span class="nt">&lt;LegendURL</span> <span class="na">width=</span><span class="s">&quot;268&quot;</span> <span class="na">height=</span><span class="s">&quot;32&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;Format&gt;</span>image/png<span class="nt">&lt;/Format&gt;</span>
<span class="nt">&lt;OnlineResource</span> <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;http://wms.mapama.gob.es/sig/Agua/RedHidrograficaMDT/Leyenda/RedHidrograficaBasica.png&quot;</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/LegendURL&gt;</span>
<span class="nt">&lt;/Style&gt;</span>
<span class="nt">&lt;Style&gt;</span>
<span class="nt">&lt;Name&gt;</span>HY.PhysicalWaters.Waterbodies.Default.Polyline<span class="nt">&lt;/Name&gt;</span>
<span class="nt">&lt;Title&gt;</span>Water bodies default style<span class="nt">&lt;/Title&gt;</span>
<span class="nt">&lt;Abstract&gt;</span>
Estilo de representación INSPIRE: Physical waters as watercourses or standing water can be portrayed with different geometries depending on its dimensions and the level of detail or resolution. Lineal watercourses are depicted by solid blue (#33CCFF) lines with stroke width of 1 pixel and the superficial ones are depicted by filled blue light polygons (#CCFFFF) without border. Punctual standing waters are depicted by dark blue (#0066FF) circles with size of 6 pixel and the superficial ones are depicted by filled blue light polygons (#CCFFFF) without border.
<span class="nt">&lt;/Abstract&gt;</span>
<span class="nt">&lt;LegendURL&gt;</span>
<span class="nt">&lt;Format&gt;</span>image/png<span class="nt">&lt;/Format&gt;</span>
<span class="nt">&lt;OnlineResource</span> <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;http://wms.mapama.gob.es/sig/Agua/RedHidrograficaMDT/wms.aspx?VERSION=1.1.0&amp;REQUEST=GetLegendGraphic&amp;LAYER=HY.PhysicalWaters.Waterbodies&amp;STYLE=HY.PhysicalWaters.Waterbodies.Default.Polyline&amp;FORMAT=image/png&quot;</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/LegendURL&gt;</span>
<span class="nt">&lt;StyleSheetURL&gt;</span>
<span class="nt">&lt;Format&gt;</span>text/xml<span class="nt">&lt;/Format&gt;</span>
<span class="nt">&lt;OnlineResource</span> <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;http://wms.mapama.gob.es/sig/Agua/RedHidrograficaMDT/wms.aspx?request=GetStyles&amp;layers=HY.PhysicalWaters.Waterbodies&amp;version=1.3.0&quot;</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/StyleSheetURL&gt;</span>
<span class="nt">&lt;/Style&gt;</span>
<span class="nt">&lt;/Layer&gt;</span>
</pre></div>
</td></tr></table>

<p>Otro parámetro importante a tener en cuenta es el valor de <code>queryable</code> que aparece en la capa. Un valor 1 (<code>true</code>) significa que la capa es consultable mientras que un valor 0 (<code>false</code>) indica que no lo es.</p>
<p>Configuraremos la capa</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Interactuando con el servidor con OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">toner</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;toner&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
<span class="hll">        <span class="kr">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
</span><span class="hll">          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://wms.mapama.es/sig/Agua/RedHidrograficaMDT/wms.aspx?&#39;</span><span class="p">,</span>
</span><span class="hll">          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;HY.PhysicalWaters.Waterbodies&#39;</span><span class="p">}</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">rios</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">source</span>
</span><span class="hll">        <span class="p">})</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">center</span><span class="o">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">],</span>
</span><span class="hll">            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
</span><span class="hll">            <span class="nx">projection</span><span class="o">:</span> <span class="s1">&#39;EPSG:4326&#39;</span>
</span><span class="hll">            <span class="p">})</span>
</span>        <span class="kr">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span> <span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">toner</span><span class="p">,</span>
<span class="hll">                <span class="nx">rios</span>
</span>            <span class="p">]</span>
        <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Ahora configuraremos el control que nos permite hacer las consultas. Lo que haremos será obtener una url que nos permitirá consultar al servicio los datos de donde estemos pinchando.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Interactuando con el servidor con OpenLayers<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;info&quot;</span> <span class="na">style</span><span class="o">=</span><span class="s">&quot;width: 100%&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
        <span class="kr">const</span> <span class="nx">toner</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Tile</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Stamen</span><span class="p">({</span>
                <span class="nx">layer</span><span class="o">:</span> <span class="s1">&#39;toner&#39;</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">source</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://wms.mapama.es/sig/Agua/RedHidrograficaMDT/wms.aspx?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;HY.PhysicalWaters.Waterbodies&#39;</span><span class="p">}</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">rios</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">view</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">8.8120584</span><span class="p">,</span> <span class="mf">42.2154941</span><span class="p">],</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="nx">projection</span><span class="o">:</span> <span class="s1">&#39;EPSG:4326&#39;</span>
            <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span> <span class="p">,</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">toner</span><span class="p">,</span>
                <span class="nx">rios</span>
            <span class="p">]</span>
        <span class="p">});</span>

<span class="hll">        <span class="nx">map</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;singleclick&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">            <span class="kr">const</span> <span class="nx">viewResolution</span> <span class="o">=</span> <span class="nx">view</span><span class="p">.</span><span class="nx">getResolution</span><span class="p">();</span>
</span><span class="hll">            <span class="kr">const</span> <span class="nx">url</span> <span class="o">=</span> <span class="nx">source</span><span class="p">.</span><span class="nx">getGetFeatureInfoUrl</span><span class="p">(</span>
</span><span class="hll">            <span class="nx">evt</span><span class="p">.</span><span class="nx">coordinate</span><span class="p">,</span> <span class="nx">viewResolution</span><span class="p">,</span> <span class="s1">&#39;EPSG:4326&#39;</span><span class="p">,</span>
</span><span class="hll">            <span class="p">{</span><span class="s1">&#39;INFO_FORMAT&#39;</span><span class="o">:</span> <span class="s1">&#39;text/html&#39;</span><span class="p">});</span>
</span><span class="hll">            <span class="k">if</span> <span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">            <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;info&#39;</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span>
</span><span class="hll">                <span class="s1">&#39;&lt;iframe seamless src=&quot;&#39;</span> <span class="o">+</span> <span class="nx">url</span> <span class="o">+</span> <span class="s1">&#39;&quot; style=&quot;width: 100%; height: 300px&quot;&gt;&lt;/iframe&gt;&#39;</span><span class="p">;</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">        <span class="p">});</span>
</span>    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Lo primero a tener en cuenta es <code>map.on()</code>. Lo que hacemos aquí es engancharle una función al <a href="http://openlayers.org/en/latest/apidoc/module-ol_MapBrowserEvent-MapBrowserEvent.html#event:singleclick">evento <code>singleclick</code></a> del mapa. De esta manera, cuando pinchemos sobre el mapa, se lanzará este evento con un parámetro <code>evt</code> donde tendremos las coordenadas del punto donde hemos pinchado en el mapa. Existen variedad de eventos en el mapa sobre los que podemos interacctuar simplemente conectándonos a ellos de la misma manera</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nx">map</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;tipo_de_evento&#39;</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</pre></div>
</td></tr></table>

<p>La fuente de tipo <code>ol.source.ImageWMS</code> tiene un método que nos permite construir una url donde podremos consultar el dato que necesitamos. Los parámetros que necesita el método se consiguen desde la vista y el evento. Un parámetro importante a tener en cuenta es el <code>INFO_FORMAT</code>. Como en otros protocolos, deberemos ver en las <a href="http://wms.mapama.es/sig/Agua/RedHidrograficaMDT/wms.aspx?service=wms&amp;version=1.3.0&amp;request=GetCapabilities">capacidades</a> del servicio, los formatos de respuesta que tenemos disponibles. Con este parámetro le indicamos en que formato queremos que nos devuelva los datos.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="nt">&lt;GetFeatureInfo&gt;</span>
<span class="hll">    <span class="nt">&lt;Format&gt;</span>application/vnd.ogc.wms_xml<span class="nt">&lt;/Format&gt;</span>
</span><span class="hll">    <span class="nt">&lt;Format&gt;</span>text/xml<span class="nt">&lt;/Format&gt;</span>
</span><span class="hll">    <span class="nt">&lt;Format&gt;</span>text/html<span class="nt">&lt;/Format&gt;</span>
</span><span class="hll">    <span class="nt">&lt;Format&gt;</span>text/plain<span class="nt">&lt;/Format&gt;</span>
</span>    <span class="nt">&lt;DCPType&gt;</span>
        <span class="nt">&lt;HTTP&gt;</span>
            <span class="nt">&lt;Get&gt;</span>
                <span class="nt">&lt;OnlineResource</span> <span class="na">xmlns:xlink=</span><span class="s">&quot;http://www.w3.org/1999/xlink&quot;</span> <span class="na">xlink:type=</span><span class="s">&quot;simple&quot;</span> <span class="na">xlink:href=</span><span class="s">&quot;http://wms.mapama.gob.es/sig/Agua/RedHidrograficaMDT/wms.aspx?&quot;</span><span class="nt">/&gt;</span>
            <span class="nt">&lt;/Get&gt;</span>
        <span class="nt">&lt;/HTTP&gt;</span>
    <span class="nt">&lt;/DCPType&gt;</span>
<span class="nt">&lt;/GetFeatureInfo&gt;</span>
</pre></div>
</td></tr></table>

<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Si disponemos del formato de salida en <code>application/json</code> obtendremos los datos en <code>geojson</code> lo que nos permitiría representarlos en el mapa como vimos en ejemplos anteriores.</p>
</div>
<h2 id="interactuando-en-el-cliente">Interactuando en el cliente</h2>
<p>Siguiendo en la linea de interaccionar con los datos, en el ejemplo anterior vimos como obtener datos de un servidor. Como ya hemos comentado en otras secciones del curso, hay casos en los que el volumen de datos nos permite descargar estos en el cliente mediante una petición. Por ejemplo usando el servicio <em>WFS</em> del que ya hemos hablado. </p>
<p>Creamos de nuevo una carpeta <code>ol-dataclient</code> y creamos nuestro archivo <code>index.html</code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Interactuando en el cliente<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
     <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
      <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
          <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
        <span class="p">})</span>
      <span class="p">})</span>
      <span class="kr">const</span> <span class="nx">vectorSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
        <span class="nx">format</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">(),</span>
        <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extent</span><span class="p">)</span> <span class="p">{</span>
          <span class="k">return</span> <span class="s1">&#39;https://cors-anywhere.herokuapp.com/http://ideadif.adif.es/gservices/Tramificacion/wfs?service=WFS&amp;version=1.1.0&amp;&#39;</span> <span class="o">+</span> 
            <span class="s1">&#39;request=GetFeature&amp;typename=Tramificacion:TramosFueraServicio&amp;outputFormat=application/json&amp;srsname=EPSG:3857&amp;&#39;</span><span class="p">;</span>
        <span class="p">},</span>
        <span class="nx">strategy</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">loadingstrategy</span><span class="p">.</span><span class="nx">all</span>
      <span class="p">});</span>
      <span class="kr">const</span> <span class="nx">tramos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
        <span class="nx">source</span><span class="o">:</span> <span class="nx">vectorSource</span><span class="p">,</span>
        <span class="nx">style</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Style</span><span class="p">({</span>
          <span class="nx">stroke</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Stroke</span><span class="p">({</span>
            <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
            <span class="nx">width</span><span class="o">:</span> <span class="mi">2</span>
          <span class="p">})</span>
        <span class="p">})</span>
      <span class="p">});</span>
      <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
        <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
        <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
          <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">3.6832130</span><span class="p">,</span> <span class="mf">40.2589448</span><span class="p">]),</span>
          <span class="nx">zoom</span><span class="o">:</span> <span class="mi">6</span>
        <span class="p">}),</span>
      <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
        <span class="nx">PNOA</span><span class="p">,</span>
        <span class="nx">tramos</span>
      <span class="p">]</span>
      <span class="p">});</span>
    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>Lo que tendremos es el resultado del ejercicio del WFS que utilizaremos como base para explorar las consultas en el cliente. Tras la carga de del servicio WFS (revisar la pestaña <em>Network</em> ya que esta consulta puede tardar bastante dependiendo de la velocidad de la red) tendremos todas las geometrías descargadas en nuestro cliente. Si abrimos la pestaña <em>Network</em> y movemos el mapa, veremos que ya no se hacen peticiones al servicio WFS (<code>wfs?service=WFS&amp;...</code>) ya que disponemos de todos los datos en el cliente.</p>
<p><img alt="No peticiones WFS" src="../_images/no_wfs.gif" /></p>
<p>Ahora la interacción desde el cliente con los datos del cliente será inmediata. Deberemos usar los objetos <code>ol.interaction.Select</code> que nos permitirán añadir esa interacción al mapa. </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">title</span><span class="p">&gt;</span>Interactuando en el cliente<span class="p">&lt;/</span><span class="nt">title</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">link</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;https://openlayers.org/en/v5.2.0/css/ol.css&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;map&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;map&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="hll">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;div-data-features&quot;</span><span class="p">&gt;</span>
</span><span class="hll">        <span class="p">&lt;</span><span class="nt">table</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;data-features&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</span><span class="hll">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://cdn.rawgit.com/openlayers/openlayers.github.io/master/en/v5.2.0/build/ol.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
<span class="hll">        <span class="c1">// Utilidad para crear una tabla</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">createTableFromFeature</span> <span class="o">=</span> <span class="nx">feature</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class="hll">            <span class="kr">const</span> <span class="nx">div</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;div-data-features&#39;</span><span class="p">);</span>
</span><span class="hll">            <span class="kd">let</span> <span class="nx">table</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;data-features&#39;</span><span class="p">);</span>
</span><span class="hll">            <span class="k">if</span> <span class="p">(</span><span class="nx">table</span><span class="p">)</span> <span class="p">{</span>
</span><span class="hll">                <span class="nx">div</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">table</span><span class="p">)</span>
</span><span class="hll">                <span class="nx">table</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">);</span>
</span><span class="hll">                <span class="nx">table</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="s1">&#39;data-features&#39;</span><span class="p">;</span>
</span><span class="hll">                <span class="nx">div</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">table</span><span class="p">);</span>
</span><span class="hll">            <span class="p">}</span>
</span><span class="hll">            <span class="kr">const</span> <span class="nx">properties</span> <span class="o">=</span> <span class="nx">feature</span><span class="p">.</span><span class="nx">getProperties</span><span class="p">()</span>
</span><span class="hll">            <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">properties</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">key</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class="hll">                <span class="k">if</span> <span class="p">(</span><span class="nx">properties</span><span class="p">[</span><span class="nx">key</span><span class="p">])</span> <span class="p">{</span>
</span><span class="hll">                    <span class="kr">const</span> <span class="nx">row</span> <span class="o">=</span> <span class="nx">table</span><span class="p">.</span><span class="nx">insertRow</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class="hll">                    <span class="kr">const</span> <span class="nx">cell1</span> <span class="o">=</span> <span class="nx">row</span><span class="p">.</span><span class="nx">insertCell</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class="hll">                    <span class="kr">const</span> <span class="nx">cell2</span> <span class="o">=</span> <span class="nx">row</span><span class="p">.</span><span class="nx">insertCell</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class="hll">                    <span class="nx">cell1</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">key</span><span class="p">;</span>
</span><span class="hll">                    <span class="nx">cell2</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">properties</span><span class="p">[</span><span class="nx">key</span><span class="p">];</span>
</span><span class="hll">                <span class="p">}</span>
</span><span class="hll">            <span class="p">})</span>
</span><span class="hll">        <span class="p">}</span>
</span><span class="hll">        <span class="c1">//</span>
</span>        <span class="kr">const</span> <span class="nx">PNOA</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Image</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">ImageWMS</span><span class="p">({</span>
            <span class="nx">url</span><span class="o">:</span> <span class="s1">&#39;http://www.ign.es/wms-inspire/pnoa-ma?&#39;</span><span class="p">,</span>
            <span class="nx">params</span><span class="o">:</span> <span class="p">{</span><span class="s1">&#39;LAYERS&#39;</span><span class="o">:</span> <span class="s1">&#39;OI.OrthoimageCoverage&#39;</span><span class="p">},</span>
            <span class="p">})</span>
        <span class="p">})</span>
        <span class="kr">const</span> <span class="nx">vectorSource</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">source</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
            <span class="nx">format</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">format</span><span class="p">.</span><span class="nx">GeoJSON</span><span class="p">(),</span>
            <span class="nx">url</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">extent</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s1">&#39;https://cors-anywhere.herokuapp.com/http://ideadif.adif.es/gservices/Tramificacion/wfs?service=WFS&amp;version=1.1.0&amp;&#39;</span> <span class="o">+</span> 
                <span class="s1">&#39;request=GetFeature&amp;typename=Tramificacion:TramosFueraServicio&amp;outputFormat=application/json&amp;srsname=EPSG:3857&amp;&#39;</span><span class="p">;</span>
            <span class="p">},</span>
            <span class="nx">strategy</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">loadingstrategy</span><span class="p">.</span><span class="nx">all</span>
        <span class="p">});</span>
        <span class="kr">const</span> <span class="nx">tramos</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">layer</span><span class="p">.</span><span class="nx">Vector</span><span class="p">({</span>
            <span class="nx">source</span><span class="o">:</span> <span class="nx">vectorSource</span><span class="p">,</span>
            <span class="nx">style</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Style</span><span class="p">({</span>
            <span class="nx">stroke</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">Stroke</span><span class="p">({</span>
                <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
                <span class="nx">width</span><span class="o">:</span> <span class="mi">2</span>
            <span class="p">})</span>
            <span class="p">})</span>
        <span class="p">});</span>
        <span class="kd">let</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">Map</span><span class="p">({</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">&#39;map&#39;</span><span class="p">,</span>
            <span class="nx">view</span><span class="o">:</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">View</span><span class="p">({</span>
            <span class="nx">center</span><span class="o">:</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">proj</span><span class="p">.</span><span class="nx">fromLonLat</span><span class="p">([</span><span class="o">-</span><span class="mf">3.6832130</span><span class="p">,</span> <span class="mf">40.2589448</span><span class="p">]),</span>
            <span class="nx">zoom</span><span class="o">:</span> <span class="mi">6</span>
            <span class="p">}),</span>
            <span class="nx">layers</span><span class="o">:</span> <span class="p">[</span>
                <span class="nx">PNOA</span><span class="p">,</span>
                <span class="nx">tramos</span>
            <span class="p">]</span>
        <span class="p">});</span>

<span class="hll">        <span class="c1">// Añadimos interacción</span>
</span><span class="hll">        <span class="kr">const</span> <span class="nx">selectSingleClick</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ol</span><span class="p">.</span><span class="nx">interaction</span><span class="p">.</span><span class="nx">Select</span><span class="p">({</span>
</span><span class="hll">            <span class="nx">hitTolerance</span><span class="o">:</span> <span class="mi">5</span>
</span><span class="hll">        <span class="p">});</span>
</span><span class="hll">        <span class="nx">map</span><span class="p">.</span><span class="nx">addInteraction</span><span class="p">(</span><span class="nx">selectSingleClick</span><span class="p">);</span>
</span><span class="hll">            <span class="nx">selectSingleClick</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;select&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class="hll">                <span class="nx">e</span><span class="p">.</span><span class="nx">selected</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">feature</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span><span class="hll">                    <span class="nx">createTableFromFeature</span><span class="p">(</span><span class="nx">feature</span><span class="p">);</span>
</span><span class="hll">                <span class="p">})</span>
</span><span class="hll">        <span class="p">});</span>
</span><span class="hll">        <span class="c1">//</span>
</span>    <span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
  <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</pre></div>
</td></tr></table>

<p>En la parte de la interacción es donde conectamos el evento del <code>singleclick</code> con el mapa. De esta manera, pulsando sobre el mismo, nos devolverá los elementos sobre los que hayamos pulsado a la vez que los selecciona. Al contrario que en el ejemplo anterior, no se está realizando ninguna consulta a un servidor externo una vez que se han descargado todos los datos. Y las interacciones se realizan dentro del cliente.</p>
<p><a href="./../leaflet/5_interactuando_mapa">Probar con Leaflet</a></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../4_wms_wmts/" title="4. Y si los datos son enormes" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Anterior
                </span>
                4. Y si los datos son enormes
              </span>
            </div>
          </a>
        
        
          <a href="../6_osm_y_tilemill/" title="6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Siguiente
                </span>
                6. Usando OpenStreetMap como fuente de datos, Tilemill. Enlace a GeoTalleres
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.583bbe55.js"></script>
      
        
        
          
          <script src="../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              
                <script src="../assets/javascripts/lunr/lunr.es.js"></script>
              
            
          
          
        
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>